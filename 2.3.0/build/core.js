define('kg/xscroll/2.3.0/core',["./base","./util","./event","./pan","./tap","./pinch","./timer","./scrollbar","./pulldown","./pullup","./boundry","./easing"],function(require, exports, module) {var e=require("./base"),n=require("./util"),t=require("./event"),i=require("./pan"),r=require("./tap"),o=require("./pinch"),a=require("./timer"),s=require("./scrollbar"),c=require("./pulldown"),l=require("./pullup"),f=require("./boundry"),u=require("./easing"),d=function(e){d.superclass.constructor.call(this),this.userConfig=e,this.init()};d.Util=n,d.Plugin={PullDown:c,PullUp:l};var h="scrollend",g="scroll",p="panend",C="panstart",y="pan",_="pinchstart",b="pinch",m="pinchend",x="scrollanimate",v="scaleanimate",S="scale",T="afterrender",w="refresh",Y=.001,X=400,E="ease",N=.1,H=.36,O=300,A=n.prefixStyle("transform"),I=n.prefixStyle("transition"),k=n.prefixStyle("transitionDuration"),R=n.prefixStyle("transformOrigin"),B=n.vendor?n.prefixStyle("transitionEnd"):"transitionend",M=n.vendor?["-",n.vendor,"-transform"].join(""):"transform",W=function(e,n){if(!(e.touches.length>1)){var t=e.changedTouches,i=t[0],r=document.createEvent("MouseEvent");r.initMouseEvent(n,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(r)}};n.extend(d,e,{version:"2.3.0",init:function(){var e=this,t=e.userConfig=n.mix({snap:!1,snapWidth:100,snapHeight:100,snapRowIndex:0,snapColIndex:0,snapEasing:"ease",snapDuration:500,snapColsNum:1,snapRowsNum:1,bounce:!0,bounceDirections:["top","right","bottom","left"],scalable:!1,scrollbarX:!0,scrollbarY:!0,bounceSize:100,useTransition:!0,gpuAcceleration:!0,BOUNDRY_CHECK_EASING:E,BOUNDRY_CHECK_DURATION:X,BOUNDRY_CHECK_ACCELERATION:N,easing:"quadratic"},e.userConfig,void 0,void 0,!0);e.guid=n.guid(),e.renderTo=t.renderTo.nodeType?t.renderTo:document.querySelector(t.renderTo),e.scale=t.scale||1,e.timer={},e.boundryCheckEnabled=!0;var i=e.clsPrefix=t.clsPrefix||"xs-";e.SROLL_ACCELERATION=t.SROLL_ACCELERATION||Y,e.containerClsName=i+"container",e.contentClsName=i+"content",e.boundry=new f,e.boundry.refresh()},refresh:function(){var e=this;e.render(),e.scrollTo({x:0,y:0}),e.fire(w)},render:function(){var e=this,n=e.userConfig;e._createContainer();var t=n.width||e.renderTo.offsetWidth,i=n.height||e.renderTo.offsetHeight||0;e.width=t,e.height=i;var r=n.containerWidth||e.content.offsetWidth,o=n.containerHeight||e.content.offsetHeight;e.containerWidth=r<e.width?e.width:r,e.containerHeight=o<e.height?e.height:o,e.initialContainerWidth=e.containerWidth,e.initialContainerHeight=e.containerHeight;var a=e.userConfig.minScale||Math.max(e.width/e.containerWidth,e.height/e.containerHeight),s=e.userConfig.maxScale||1;e.minScale=a,e.maxScale=s,e.boundry.refresh({width:e.scale*e.width,height:e.scale*e.height}),e.fire(T),e.renderScrollBars(),e.userConfig.snap&&e.initSnap(),e._bindEvt()},renderScrollBars:function(){var e=this;e.userConfig.scrollbarX&&(e.scrollbarX?e.scrollbarX._update():e.scrollbarX=new s({xscroll:e,type:"x"})),e.userConfig.scrollbarY&&(e.scrollbarY?e.scrollbarY._update():e.scrollbarY=new s({xscroll:e,type:"y"}))},_createContainer:function(){var e=this;if(!e.__isContainerCreated){var n=(e.renderTo,e.container=e.renderTo.getElementsByClassName(e.containerClsName)[0]),t=e.content=e.renderTo.getElementsByClassName(e.contentClsName)[0];n.style.position="absolute",n.style.height="100%",n.style.width="100%",n.style[R]="0 0",t.style.position="absolute",t.style[R]="0 0",e.translate({x:0,y:0}),e.__isContainerCreated=!0}},translate:function(e){this.translateX(e.x),this.translateY(e.y)},_scale:function(e,n,t){var i=this;if(i.userConfig.scalable&&i.scale!=e&&e){i.isScaling||(i.scaleBegin=i.scale,i.isScaling=!0,i.scaleBeginX=i.x,i.scaleBeginY=i.y),n&&(i.originX=n),t&&(i.originY=t);var r=i.boundry,o=e*i.initialContainerWidth,a=e*i.initialContainerHeight;i.containerWidth=Math.round(o>i.width?o:i.width),i.containerHeight=Math.round(a>i.height?a:i.height),i.scale=e;var s=n*(i.initialContainerWidth*i.scaleBegin-i.containerWidth)+i.scaleBeginX,c=t*(i.initialContainerHeight*i.scaleBegin-i.containerHeight)+i.scaleBeginY;s>r.left&&(s=r.left),c>r.top&&(c=r.top),s<r.right-i.containerWidth&&(s=r.right-i.containerWidth),c<r.bottom-i.containerHeight&&(c=r.bottom-i.containerHeight),i.x=s,i.y=c,i._transform(),i._noTransition()}},scaleTo:function(e,n,t,i,r){var o=this;if(o.userConfig.scalable&&o.scale!=e&&e){var i=i||1,r=r||"ease-out",s=[M," ",i/1e3,"s ",r," 0s"].join(""),c=o.scale;o.timer.scale=o.timer.scale||new a,o.timer.scale.reset({duration:i}),o.timer.scale.detach("run"),o.timer.scale.on("run",function(i){var r=(e-c)*i.percent+c;o.fire(S,{scale:r,origin:{x:n,y:t}}),o.userConfig.useTransition||o._scale(r,n,t)}),o.timer.scale.detach("end"),o.timer.scale.on("end",function(){o.isScaling=!1}),o.userConfig.useTransition&&(o._scale(e,n,t),o.container.style[I]=s,o.content.style[I]=s),o.timer.scale.run(),o.fire(v,{scale:o.scale,duration:i,easing:r,offset:{x:o.x,y:o.y},origin:{x:n,y:t}})}},translateX:function(e){this.x=e,this._transform()},translateY:function(e){this.y=e,this._transform()},_noTransition:function(){var e=this;n.isBadAndroid?(e.content.style[k]="0.001s",e.container.style[k]="0.001s"):(e.content.style[I]="none",e.container.style[I]="none")},stop:function(){var e=this;if(!e.isScaling){var n=e.boundry,t=e.getOffset();if(!(t.y>n.top||t.y+e.containerHeight<n.bottom||t.x>n.left||t.x+e.containerWidth<n.right)){if(e.userConfig.useTransition)e.translate(t),e._noTransition();else for(var i in e.timer)e.timer[i].stop();e._bouncex=0,e._bouncey=0,e.fire(h,{offset:t,scale:e.scale,zoomType:"xy"})}}},enableGPUAcceleration:function(){this.userConfig.gpuAcceleration=!0},disableGPUAcceleration:function(){this.userConfig.gpuAcceleration=!1},_transform:function(){var e=this.userConfig.gpuAcceleration?" translateZ(0) ":"",n=this.userConfig.scalable?" scale("+this.scale+") ":"";this.content.style[A]="translate("+this.x+"px,0px) "+n+e,this.userConfig.lockY||(this.container.style[A]="translate(0px,"+this.y+"px) "+e)},getOffset:function(){var e=this;return{x:e.getOffsetLeft(),y:e.getOffsetTop()}},getOffsetTop:function(){if(this.lockY)return 0;var e=window.getComputedStyle(this.container)[A].match(/[-\d\.*\d*]+/g);return e?Math.round(e[5]):0},getOffsetLeft:function(){if(this.lockX)return 0;var e=window.getComputedStyle(this.content)[A].match(/[-\d\.*\d*]+/g);return e?Math.round(e[4]):0},scrollTo:function(e,n,t,i){var r=this,o=r.getOffset(),a=void 0===e.x||isNaN(e.x)?-o.x:e.x,s=void 0===e.y||isNaN(e.y)?-o.y:e.y;r.scrollX(a,n,t,i),r.scrollY(s,n,t,i)},scrollBy:function(e,n,t,i){var r=this;r.scrollByX(e.x,n,t,i),r.scrollByY(e.y,n,t,i)},scrollByX:function(e,n,t,i){var r=this,o=-r.getOffsetLeft();r.scrollX(Number(e)+Number(o),n,t,i)},scrollByY:function(e,n,t,i){var r=this,o=-r.getOffsetTop();r.scrollY(Number(e)+Number(o),n,t,i)},scrollX:function(e,n,t,i){var r=this,e=Math.round(e);if(!r.userConfig.lockX){var n=n||0,t=t||r.userConfig.easing;r._scrollHandler(-e,n,i,t,"x")}},scrollY:function(e,n,t,i){var r=this,e=Math.round(e);if(!r.userConfig.lockY){var n=n||0,t=t||r.userConfig.easing;r._scrollHandler(-e,n,i,t,"y")}},_scrollHandler:function(e,n,t,i,r){var o=this,s=o.getOffset(),c="x"==r?["left","right"]:["top","bottom"],l=r.toUpperCase(),f="x"==r?o.content:o.container,d="none",p=function(n){o["isScrolling"+l]=!1;var i={offset:o.getOffset(),zoomType:n.type,type:h};i["direction"+n.type.toUpperCase()]=e-s[n.type]<0?c[1]:c[0],o.fire(h,i),t&&t(n)};return o.userConfig.useTransition&&(d=n>0?[M," ",n/1e3,"s ",u.format(i)," 0s"].join(""):"none",f.style[I]=d,"x"==r?o.translateX(e):o.translateY(e)),o.timer[r]=o.timer[r]||new a,o.timer[r].reset({duration:n,easing:i}),o.timer[r].detach("run"),o.timer[r].on("run",function(n){var t={zoomType:r,offset:o.getOffset(),type:g};t["direction"+r.toUpperCase()]=e-s[r]<0?c[1]:c[0],o.userConfig.useTransition||("x"==r?o.translateX(n.percent*(e-s[r])+s[r]):o.translateY(n.percent*(e-s[r])+s[r])),o.fire(g,t)}),o.timer[r].detach("end"),o.timer[r].on("end",function(){o.userConfig.useTransition||p({type:r})}),o.timer[r].stop(),o.timer[r].run(),0>=n||e==s[r]?(o.fire(g,{zoomType:r,offset:s,type:g}),void o.fire(h,{zoomType:r,offset:s,type:h})):(o["isScrolling"+l]=!0,o.userConfig.useTransition&&(o["__scrollEndCallback"+l]=p),void o.fire(x,{transition:d,offset:{x:o.x,y:o.y},duration:n/1e3,easing:u.format(i),zoomType:r}))},boundryCheckX:function(e){var n=this;if(n.boundryCheckEnabled&&!n.userConfig.lockX){var t=n.getOffset(),i=n.containerWidth,r=n.boundry;t.x>r.left?(t.x=r.left,n.scrollX(-t.x,n.userConfig.BOUNDRY_CHECK_DURATION,n.userConfig.BOUNDRY_CHECK_EASING,e)):t.x+i<r.right&&(t.x=r.right-i,n.scrollX(-t.x,n.userConfig.BOUNDRY_CHECK_DURATION,n.userConfig.BOUNDRY_CHECK_EASING,e))}},boundryCheckY:function(e){var n=this;if(n.boundryCheckEnabled&&!n.userConfig.lockY){var t=n.getOffset(),i=n.containerHeight,r=n.boundry;t.y>r.top?(t.y=r.top,n.scrollY(-t.y,X,E,e)):t.y+i<r.bottom&&(t.y=r.bottom-i,n.scrollY(-t.y,X,E,e))}},boundryCheck:function(e){this.boundryCheckX(e),this.boundryCheckY(e)},bounce:function(e,n){this.boundryCheckEnabled=e,e?this.boundryCheck(n):void 0},_fireTouchStart:function(e){this.fire("touchstart",e)},_firePanStart:function(e){this.fire(C,e)},_firePan:function(e){this.fire(y,e)},_firePanEnd:function(e){this.fire(p,e)},_fireClick:function(e,n){this.fire(e,n)},__handlers:{touchstart:function(e){var n=this;e.preventDefault(),n._fireTouchStart(e),(n.isScrollingX||n.isScrollingY)&&n.stop()},tap:function(e){var n=this;n._fireClick("click",e),n.isScrollingX||n.isScrollingY?(n.isScrollingX=!1,n.isScrollingY=!1):W(e,"click")},panstart:function(e){var t=this;t._prevSpeed=0;{var i=t.offset=t.getOffset();t.boundry,t.containerWidth,t.containerHeight,t.boundry}return t.translate(i),t._firePanStart(n.mix(e,{offset:i})),i},pan:function(e){var t=this,i=t.boundry,r=t.userConfig.lockY?Number(t.offset.y):Number(t.offset.y)+e.deltaY,o=t.userConfig.lockX?Number(t.offset.x):Number(t.offset.x)+e.deltaX,a=t.userConfig.bounce,s=t.containerWidth,c=t.containerHeight;r>i.top&&(r=a||xscroll.getPlugin("xscroll/plugin/pulldown")?(r-i.top)*H+i.top:i.top),r<i.bottom-c&&(r=a?r+(i.bottom-c-r)*H:i.bottom-c),o>i.left&&(o=a?(o-i.left)*H+i.left:i.left),o<i.right-s&&(o=a?o+(i.right-s-o)*H:i.right-s),t.translate({x:o,y:r}),t._noTransition(),t.isScrollingX=!1,t.isScrollingY=!1,t.directionX="left"==e.directionX?"right":"right"==e.directionX?"left":"",t.directionY="top"==e.directionY?"bottom":"bottom"==e.directionY?"top":"",t._firePan(n.mix(e,{offset:{x:o,y:r},directionX:e.directionX,directionY:e.directionY,triggerType:y})),t.fire(g,n.mix(e,{offset:{x:o,y:r},directionX:t.directionX,directionY:t.directionY,triggerType:y}))},panend:function(e){{var n=this;n.getOffset(),n.boundry}n.userConfig.snap?n._snapAnimate(e):n._scrollAnimate(e),delete n.offset,n._firePanEnd(e)}},_bindEvt:function(){var e=this;if(!e.__isEvtBind){e.__isEvtBind=!0;{var n=e.renderTo,a=e.container,s=e.content;e.containerWidth,e.containerHeight}if(t.on(n,"touchstart",function(n){e.__handlers.touchstart.call(e,n)}).on(n,r.TAP,function(n){e.__handlers.tap.call(e,n)}).on(n,i.PAN_START,function(n){e.__handlers.panstart.call(e,n)}).on(n,i.PAN,function(n){e.__handlers.pan.call(e,n)}).on(n,i.PAN_END,function(n){e.__handlers.panend.call(e,n)}),e.userConfig.useTransition&&t.on(a,B,function(n){n.target!=s||e.isScaling||e.__scrollEndCallbackX&&e.__scrollEndCallbackX({type:"x"}),n.target!=a||e.isScaling||e.__scrollEndCallbackY&&e.__scrollEndCallbackY({type:"y"})},!1),e.userConfig.scalable){var c,l;o.init(),t.on(n,o.PINCH_START,function(n){scale=e.scale,c=(n.origin.pageX-e.x)/e.containerWidth,l=(n.origin.pageY-e.y)/e.containerHeight,e.fire(_,{scale:scale,origin:{x:c,y:l}})}),t.on(n,o.PINCH,function(n){var t=scale*n.scale;t<=e.userConfig.minScale&&(t=.5*e.userConfig.minScale*Math.pow(2,t/e.userConfig.minScale)),t>=e.userConfig.maxScale&&(t=2*e.userConfig.maxScale*Math.pow(.5,e.userConfig.maxScale/t)),e._scale(t,c,l),e.fire(b,{scale:t,origin:{x:c,y:l}})}),t.on(n,o.PINCH_END,function(){e.isScaling=!1,e.scale<e.minScale?e.scaleTo(e.minScale,c,l,O):e.scale>e.maxScale&&e.scaleTo(e.maxScale,c,l,O),e.fire(m,{scale:scale,origin:{x:c,y:l}})}),t.on(n,r.DOUBLE_TAP,function(n){c=(n.pageX-e.x)/e.containerWidth,l=(n.pageY-e.y)/e.containerHeight,e.scale>e.minScale?e.scaleTo(e.minScale,c,l,200):e.scaleTo(e.maxScale,c,l,200)})}t.on(window,"resize",function(){e.refresh()})}},initSnap:function(){var e=this;e.snapRowIndex=e.userConfig.snapRowIndex,e.snapColIndex=e.userConfig.snapColIndex},snapTo:function(e,n,t){var i=this,r=i.userConfig,o=r.snapWidth,a=r.snapHeight,s=r.snapColsNum,c=r.snapRowsNum;e=e>=s?s-1:0>e?0:e,n=n>=c?c-1:0>n?0:n,i.snapRowIndex=n,i.snapColIndex=e;var l=i.snapRowIndex*a,f=i.snapColIndex*o;i.scrollTo({x:f,y:l},r.snapDuration,r.snapEasing,t)},_snapAnimate:function(e){var n=this,t=n.userConfig,i=t.snapWidth,r=t.snapHeight,o=Math.abs(e.deltaX)>Math.abs(e.deltaY)?e.touch.directionX:e.touch.directionY;if(e.velocity>.5)"left"==o?n.snapColIndex++:"right"==o?n.snapColIndex--:void 0,"top"==o?n.snapRowIndex++:"bottom"==o?n.snapRowIndex--:void 0;else{var a=n.getOffset(),s=Math.abs(a.x),c=Math.abs(a.y);n.snapColIndex=Math.round(s/i),n.snapRowIndex=Math.round(c/r)}n.snapTo(n.snapColIndex,n.snapRowIndex)},_scrollAnimate:function(e){var n,t=this,i=(t.userConfig,t._bounce("x",e.velocityX)),r=t._bounce("y",e.velocityY),o=i?i.offset:0,a=r?r.offset:0;i&&r&&i.status&&r.status&&i.duration&&r.duration&&(n=Math.max(i.duration,r.duration)),i&&t.scrollX(o,n||i.duration,i.easing,function(){t._scrollEndHandler("x")}),r&&t.scrollY(a,n||r.duration,r.easing,function(){t._scrollEndHandler("y")}),t.directionX=e.velocityX<0?"left":"right",t.directionY=e.velocityY<0?"up":"down"},_scrollEndHandler:function(e){var n=this,t=e.toUpperCase(),i="scroll"+t,r="boundryCheck"+t,o="_bounce"+e,a=n.boundry,s=n.userConfig.bounceSize||0;if(n[o]){var c="x"==e?a.left:a.top,l="x"==e?a.right:a.bottom,f="x"==e?n.containerWidth:n.containerHeight,u={zoomType:e,velocityX:0,velocityY:0};if(u["velocity"+t]=n[o],n.fire("boundryout",u),n.userConfig.bounce){var d=n[o],h=.01*d/Math.abs(d),g=d/h,p=n.getOffset()[e]+g*d/2,C=100,y=150,_=0;p>c?(p>c+s&&(p=c+s),_=Math.abs(p-c)):l-f>p&&(l-f-s>p&&(p=l-f-s),_=Math.abs(l-f-p)),g=_/s*(y-C)+C,n[i](-p,g,"linear",function(){n[o]=0,n[r]()})}}else n[r]()},_bounce:function(e,n){var t=this,i=t.getOffset()[e],r=t.boundry,o="x"==e?r.left:r.top,a="x"==e?r.right:r.bottom,s="x"==e?t.containerWidth:t.containerHeight,c=a-o,l=t.userConfig,f={};if(0===n)return void("x"==e?t.boundryCheckX():t.boundryCheckY());if(!("x"==e&&t.userConfig.lockX||"y"==e&&t.userConfig.lockY)){var u=l.maxSpeed>0&&l.maxSpeed<6?l.maxSpeed:3;if(n>u&&(n=u),-u>n&&(n=-u),i>o||c-s>i){var d=l.BOUNDRY_CHECK_ACCELERATION*(n/Math.abs(n)),h=n/d,g=i+h*n/2;return f.offset=-g,f.duration=h,f}var d=t.SROLL_ACCELERATION*(n/Math.abs(n)),h=n/d,g=i/1+h*n/2;if(g>o){var p=o-i,C=(n-Math.sqrt(-2*d*p+n*n))/d;f.offset=-o,f.duration=C,f.easing="linear",t["_bounce"+e]=n-d*C,t._prevSpeed=0}else if(c-s>g){var p=c-s-i,C=(n+Math.sqrt(-2*d*p+n*n))/d;f.offset=s-c,f.duration=C,f.easing="linear",t["_bounce"+e]=n-d*C,t._prevSpeed=n-d*C}else f.offset=-g,f.duration=h,f.easing=t.userConfig.easing,f.status="normal",t["_bounce"+e]=0,t._prevSpeed=0;return t["isScrolling"+e.toUpperCase()]=!0,f}},addView:function(e){var n=this;if(e&&!(!e instanceof d))return n.__subViews||(n.__subViews=[]),e.guid&&!n.getViewById(e.guid)?(e.parentView={instance:n},e.on("boundryout",function(e){n._scrollAnimate(e)}),n.__subViews.push(e)):void 0},getViewById:function(e){var n=this;if(n.__subViews)for(var t=0,i=n.__subViews.length;i>t;t++)if(e&&e==n.__subViews[t].guid)return n.__subViews[t]},getViews:function(){return this.__subViews},removeView:function(e){for(var n=this,t=0,i=n.__subViews.length;i>t;t++)if(e&&e==n.__subViews[t].guid)return delete n.__subViews[t].parentView,n.__subViews.splice(t,1)}}),window.XScroll=d,module.exports=d;});
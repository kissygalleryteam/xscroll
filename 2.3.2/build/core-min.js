KISSY.add("kg/xscroll/2.3.2/core",["./base","./util","./event","./pan","./tap","./pinch","./timer","./scrollbar","./pulldown","./pullup","./boundry","./easing"],function(e,t,n,i){var o=t("./base"),r=t("./util"),a=t("./event"),s=t("./pan"),c=t("./tap"),l=t("./pinch"),u=t("./timer"),f=t("./scrollbar"),d=t("./pulldown"),h=t("./pullup"),g=t("./boundry"),p=t("./easing"),y=function(e){y.superclass.constructor.call(this),this.userConfig=e,this.init()};y.Util=r,y.Plugin={PullDown:d,PullUp:h},y.Gesture={Pan:s,Tap:c,Pinch:l};var C="scrollend",_="scroll",b="panend",v="panstart",m="pan",x="pinchstart",S="pinch",T="pinchend",w="scrollanimate",Y="scaleanimate",O="scale",X="scaleend",E="afterrender",N="boundryout",H=.001,B=500,A="ease",k=.1,R=.36,I=300,M=r.prefixStyle("transform"),P=r.prefixStyle("transition"),W=r.prefixStyle("transitionDuration"),D=r.prefixStyle("transformOrigin"),L=r.vendor?r.prefixStyle("transitionEnd"):"transitionend",U=r.vendor?["-",r.vendor,"-transform"].join(""):"transform",V=function(e,t){if(!(e.touches.length>1)){var n=e.changedTouches,i=n[0],o=document.createEvent("MouseEvent");o.initMouseEvent(t,!0,!0,window,1,i.screenX,i.screenY,i.clientX,i.clientY,!1,!1,!1,!1,0,null),e.target.dispatchEvent(o)}};return r.extend(y,o,{version:"2.3.2",init:function(){var e=this,t=e.userConfig=r.mix({preventDefault:!0,snap:!1,snapWidth:100,snapHeight:100,snapRowIndex:0,snapColIndex:0,snapEasing:"ease",snapDuration:500,snapColsNum:1,snapRowsNum:1,bounce:!0,bounceDirections:["top","right","bottom","left"],scalable:!1,scrollbarX:!0,scrollbarY:!0,bounceSize:100,useTransition:!0,gpuAcceleration:!0,BOUNDRY_CHECK_EASING:A,BOUNDRY_CHECK_DURATION:B,BOUNDRY_CHECK_ACCELERATION:k,easing:"quadratic"},e.userConfig,void 0,void 0,!0);e.guid=r.guid(),e.renderTo=t.renderTo.nodeType?t.renderTo:document.querySelector(t.renderTo),e.scale=t.scale||1,e.timer={},e.boundryCheckEnabled=!0;var n=e.clsPrefix=t.clsPrefix||"xs-";e.SROLL_ACCELERATION=t.SROLL_ACCELERATION||H,e.containerClsName=n+"container",e.contentClsName=n+"content",e.boundry=new g,e.boundry.refresh()},render:function(){var e=this,t=e.userConfig;e._createContainer();var n=t.width||e.renderTo.offsetWidth,i=t.height||e.renderTo.offsetHeight||0;e.width=n,e.height=i;var o=t.containerWidth||e.content.offsetWidth,r=t.containerHeight||e.content.offsetHeight;e.containerWidth=o<e.width?e.width:o,e.containerHeight=r<e.height?e.height:r,e.initialContainerWidth=e.containerWidth,e.initialContainerHeight=e.containerHeight;var a=e.userConfig.minScale||Math.max(e.width/e.containerWidth,e.height/e.containerHeight),s=e.userConfig.maxScale||1;e.minScale=a,e.maxScale=s,e.boundry.refresh({width:e.scale*e.width,height:e.scale*e.height}),e.fire(E),e.renderScrollBars(),e.userConfig.snap&&e.initSnap(),e._bindEvt()},renderScrollBars:function(){var e=this;e.userConfig.scrollbarX&&(e.scrollbarX=e.scrollbarX||new f({xscroll:e,type:"x"}),e.scrollbarX._update(),e.scrollbarX.hide()),e.userConfig.scrollbarY&&(e.scrollbarY=e.scrollbarY||new f({xscroll:e,type:"y"}),e.scrollbarY._update(),e.scrollbarY.hide())},_createContainer:function(){var e=this;if(!e.__isContainerCreated){var t=(e.renderTo,e.container=e.renderTo.getElementsByClassName(e.containerClsName)[0]),n=e.content=e.renderTo.getElementsByClassName(e.contentClsName)[0];t.style.position="absolute",t.style.height="100%",t.style.width="100%",t.style[D]="0 0",n.style.position="absolute",n.style[D]="0 0",e.translate({x:0,y:0}),e.__isContainerCreated=!0}},translate:function(e){this.translateX(e.x),this.translateY(e.y)},_scale:function(e,t,n){var i=this;if(i.userConfig.scalable&&i.scale!=e&&e){i.isScaling||(i.scaleBegin=i.scale,i.isScaling=!0,i.scaleBeginX=i.x,i.scaleBeginY=i.y),t&&(i.originX=t),n&&(i.originY=n);var o=i.boundry,r=e*i.initialContainerWidth,a=e*i.initialContainerHeight;i.containerWidth=Math.round(r>i.width?r:i.width),i.containerHeight=Math.round(a>i.height?a:i.height),i.scale=e;var s=t*(i.initialContainerWidth*i.scaleBegin-i.containerWidth)+i.scaleBeginX,c=n*(i.initialContainerHeight*i.scaleBegin-i.containerHeight)+i.scaleBeginY;s>o.left&&(s=o.left),c>o.top&&(c=o.top),s<o.right-i.containerWidth&&(s=o.right-i.containerWidth),c<o.bottom-i.containerHeight&&(c=o.bottom-i.containerHeight),i.x=s,i.y=c,i._transform(),i._noTransition()}},scaleTo:function(e,t,n,i,o){var r=this;if(r.userConfig.scalable&&r.scale!=e&&e){var i=i||1,o=o||"ease-out",a=[U," ",i/1e3,"s ",o," 0s"].join(""),s=r.scale;r.timer.scale=r.timer.scale||new u,r.timer.scale.reset({duration:i}),r.timer.scale.detach("run"),r.timer.scale.on("run",function(i){var o=(e-s)*i.percent+s;r.fire(O,{type:O,scale:o,origin:{x:t,y:n}}),r.userConfig.useTransition||r._scale(o,t,n)}),r.timer.scale.detach("end"),r.timer.scale.on("end",function(){r.isScaling=!1,r.fire(X,{type:X,scale:r.scale,origin:{x:t,y:n}})}),r.userConfig.useTransition&&(r._scale(e,t,n),r.container.style[P]=a,r.content.style[P]=a),r.timer.scale.run(),r.fire(Y,{scale:r.scale,duration:i,easing:o,offset:{x:r.x,y:r.y},origin:{x:t,y:n}})}},translateX:function(e){this.x=e,this._transform()},translateY:function(e){this.y=e,this._transform()},_noTransition:function(){var e=this;r.isBadAndroid()?(e.content.style[W]="0.001s",e.container.style[W]="0.001s"):(e.content.style[P]="none",e.container.style[P]="none")},stop:function(){var e=this;if(!e.isScaling){var t=e.boundry,n=e.getOffset();if(!(n.y>t.top||n.y+e.containerHeight<t.bottom||n.x>t.left||n.x+e.containerWidth<t.right)){e.userConfig.useTransition&&(e.translate(n),e._noTransition());for(var i in e.timer)e.timer[i].stop();e._bouncex=0,e._bouncey=0,e.fire(C,{type:C,offset:n,scale:e.scale,zoomType:"xy"})}}},enableGPUAcceleration:function(){this.userConfig.gpuAcceleration=!0},disableGPUAcceleration:function(){this.userConfig.gpuAcceleration=!1},_transform:function(){var e=this.userConfig.scalable?" scale("+this.scale+") ":"",t=this.userConfig.gpuAcceleration?" translateZ(0) ":"";this.content.style[M]="translate("+this.x+"px,0px) "+e+t,this.userConfig.lockY||(this.container.style[M]="translate(0px,"+this.y+"px) "+t)},getOffset:function(){var e=this;return{x:e.getOffsetLeft(),y:e.getOffsetTop()}},getOffsetTop:function(){if(this.lockY)return 0;var e=window.getComputedStyle(this.container)[M].match(/[-\d\.*\d*]+/g);return e?Math.round(e[5]):0},getOffsetLeft:function(){if(this.lockX)return 0;var e=window.getComputedStyle(this.content)[M].match(/[-\d\.*\d*]+/g);return e?Math.round(e[4]):0},scrollTo:function(e,t,n,i){var o=this,r=o.getOffset(),a=void 0===e.x||isNaN(e.x)?-r.x:e.x,s=void 0===e.y||isNaN(e.y)?-r.y:e.y;o.scrollX(a,t,n,i),o.scrollY(s,t,n,i)},scrollBy:function(e,t,n,i){var o=this;o.scrollByX(e.x,t,n,i),o.scrollByY(e.y,t,n,i)},scrollByX:function(e,t,n,i){var o=this,r=-o.getOffsetLeft();o.scrollX(Number(e)+Number(r),t,n,i)},scrollByY:function(e,t,n,i){var o=this,r=-o.getOffsetTop();o.scrollY(Number(e)+Number(r),t,n,i)},scrollX:function(e,t,n,i){var o=this,e=Math.round(e);if(!o.userConfig.lockX){var t=t||0,n=n||o.userConfig.easing;o._scrollHandler(-e,t,i,n,"x")}},scrollY:function(e,t,n,i){var o=this,e=Math.round(e);if(!o.userConfig.lockY){var t=t||0,n=n||o.userConfig.easing;o._scrollHandler(-e,t,i,n,"y")}},boundryCheckX:function(e){var t=this;if(t.boundryCheckEnabled&&!t.userConfig.lockX){var n=t.getOffset(),i=t.containerWidth,o=t.boundry;n.x>o.left?(n.x=o.left,t.scrollX(-n.x,t.userConfig.BOUNDRY_CHECK_DURATION,t.userConfig.BOUNDRY_CHECK_EASING,e)):n.x+i<o.right&&(n.x=o.right-i,t.scrollX(-n.x,t.userConfig.BOUNDRY_CHECK_DURATION,t.userConfig.BOUNDRY_CHECK_EASING,e))}},boundryCheckY:function(e){var t=this;if(t.boundryCheckEnabled&&!t.userConfig.lockY){var n=t.getOffset(),i=t.containerHeight,o=t.boundry;n.y>o.top?(n.y=o.top,t.scrollY(-n.y,B,A,e)):n.y+i<o.bottom&&(n.y=o.bottom-i,t.scrollY(-n.y,B,A,e))}},boundryCheck:function(e){this.boundryCheckX(e),this.boundryCheckY(e)},bounce:function(e,t){this.boundryCheckEnabled=e,e?this.boundryCheck(t):void 0},_fireTouchStart:function(e){this.fire("touchstart",e)},_firePanStart:function(e){this.fire(v,e)},_firePan:function(e){this.fire(m,e)},_firePanEnd:function(e){this.fire(b,e)},_fireClick:function(e,t){this.fire(e,t)},__handlers:{touchstart:function(e){var t=this;t.userConfig.preventDefault&&e.preventDefault(),t._fireTouchStart(e),(t.isScrollingX||t.isScrollingY)&&t.stop()},tap:function(e){var t=this;if(t._fireClick("click",e),t.isScrollingX||t.isScrollingY)t.isScrollingX=!1,t.isScrollingY=!1;else if(r.isBadAndroid()&&"a"==e.target.tagName.toLowerCase()){var n=e.target.getAttribute("href");n&&(location.href=n)}else V(e,"click")},panstart:function(e){var t=this;t._prevSpeed=0;{var n=t.offset=t.getOffset();t.boundry,t.containerWidth,t.containerHeight,t.boundry}return t.translate(n),t.__panstarted=!0,t._firePanStart(r.mix(e,{offset:n})),n},pan:function(e){var t=this;if(!t.__panstarted)return void s.reset();var n=t.boundry;t.offset=t.offset||t.getOffset();var i=t.userConfig.lockY?Number(t.offset.y):Number(t.offset.y)+e.deltaY,o=t.userConfig.lockX?Number(t.offset.x):Number(t.offset.x)+e.deltaX,a=t.userConfig.bounce,c=t.containerWidth,l=t.containerHeight;i>n.top&&(i=a||t.getPlugin("xscroll/plugin/pulldown")?(i-n.top)*R+n.top:n.top),i<n.bottom-l&&(i=a?i+(n.bottom-l-i)*R:n.bottom-l),o>n.left&&(o=a?(o-n.left)*R+n.left:n.left),o<n.right-c&&(o=a?o+(n.right-c-o)*R:n.right-c),t.translate({x:o,y:i}),t._noTransition(),t.isScrollingX=!1,t.isScrollingY=!1,t.directionX="left"==e.directionX?"right":"right"==e.directionX?"left":"",t.directionY="top"==e.directionY?"bottom":"bottom"==e.directionY?"top":"",t._firePan(r.mix(e,{offset:{x:o,y:i},directionX:e.directionX,directionY:e.directionY,triggerType:m})),t.fire(_,r.mix(e,{offset:{x:o,y:i},directionX:t.directionX,directionY:t.directionY,triggerType:m}))},panend:function(e){{var t=this;t.getOffset(),t.boundry}t.__panstarted=!1,t._firePanEnd(e),e.defaultPrevented||(t.userConfig.snap?t._snapAnimate(e):t._scrollAnimate(e),delete t.offset)}},_bindEvt:function(){var e=this;if(!e.__isEvtBind){e.__isEvtBind=!0;{var t=e.renderTo,n=e.container,i=e.content;e.containerWidth,e.containerHeight}if(r.isBadAndroid()&&a.on(t,"click",function(e){"a"==e.target.tagName.toLowerCase()&&e.preventDefault()}),a.on(t,"touchstart",function(t){e.__handlers.touchstart.call(e,t)}).on(t,c.TAP,function(t){e.__handlers.tap.call(e,t)}).on(t,s.PAN_START,function(t){e.__handlers.panstart.call(e,t)}).on(t,s.PAN,function(t){e.__handlers.pan.call(e,t)}).on(t,s.PAN_END,function(t){e.__handlers.panend.call(e,t)}),e.userConfig.useTransition&&a.on(n,L,function(t){t.elapsedTime.toFixed(3)<=.001||(t.target!=i||e.isScaling||e.__scrollEndCallbackX&&e.__scrollEndCallbackX({type:"x"}),t.target!=n||e.isScaling||e.__scrollEndCallbackY&&e.__scrollEndCallbackY({type:"y"}))},!1),e.userConfig.scalable){var o,u;l.init(),a.on(t,l.PINCH_START,function(t){scale=e.scale,o=(t.origin.pageX-e.x)/e.containerWidth,u=(t.origin.pageY-e.y)/e.containerHeight,e.fire(x,{scale:scale,origin:{x:o,y:u}})}),a.on(t,l.PINCH,function(t){var n=scale*t.scale;n<=e.userConfig.minScale&&(n=.5*e.userConfig.minScale*Math.pow(2,n/e.userConfig.minScale)),n>=e.userConfig.maxScale&&(n=2*e.userConfig.maxScale*Math.pow(.5,e.userConfig.maxScale/n)),e._scale(n,o,u),e.fire(S,{scale:n,origin:{x:o,y:u}})}),a.on(t,l.PINCH_END,function(){e.isScaling=!1,e.scale<e.minScale?e.scaleTo(e.minScale,o,u,I):e.scale>e.maxScale&&e.scaleTo(e.maxScale,o,u,I),e.fire(T,{scale:scale,origin:{x:o,y:u}})}),a.on(t,c.DOUBLE_TAP,function(t){o=(t.pageX-e.x)/e.containerWidth,u=(t.pageY-e.y)/e.containerHeight,e.scale>e.minScale?e.scaleTo(e.minScale,o,u,200):e.scaleTo(e.maxScale,o,u,200)})}a.on(window,"resize",function(){setTimeout(function(){e.render(),e.boundryCheck()},100)})}},initSnap:function(){var e=this;e.snapRowIndex=e.userConfig.snapRowIndex,e.snapColIndex=e.userConfig.snapColIndex},snapTo:function(e,t,n){var i=this,o=i.userConfig,r=o.snapWidth,a=o.snapHeight,s=o.snapColsNum,c=o.snapRowsNum;e=e>=s?s-1:0>e?0:e,t=t>=c?c-1:0>t?0:t,i.snapRowIndex=t,i.snapColIndex=e;var l=i.snapRowIndex*a,u=i.snapColIndex*r;i.scrollTo({x:u,y:l},o.snapDuration,o.snapEasing,n)},_snapAnimate:function(e){var t=this,n=t.userConfig,i=n.snapWidth,o=n.snapHeight,r=Math.abs(e.deltaX)>Math.abs(e.deltaY)?e.touch.directionX:e.touch.directionY;if(e.velocity>.5)"left"==r?t.snapColIndex++:"right"==r?t.snapColIndex--:void 0,"top"==r?t.snapRowIndex++:"bottom"==r?t.snapRowIndex--:void 0;else{var a=t.getOffset(),s=Math.abs(a.x),c=Math.abs(a.y);t.snapColIndex=Math.round(s/i),t.snapRowIndex=Math.round(c/o)}t.snapTo(t.snapColIndex,t.snapRowIndex)},_scrollAnimate:function(e){var t,n=this,i=(n.userConfig,n._bounce("x",e.velocityX)),o=n._bounce("y",e.velocityY),r=i?i.offset:0,a=o?o.offset:0;i&&o&&i.status&&o.status&&i.duration&&o.duration&&(t=Math.max(i.duration,o.duration)),i&&n.scrollX(r,t||i.duration,i.easing,function(){n._scrollEndHandler("x")}),o&&n.scrollY(a,t||o.duration,o.easing,function(){n._scrollEndHandler("y")}),n.directionX=e.velocityX<0?"left":"right",n.directionY=e.velocityY<0?"up":"down"},_scrollEndHandler:function(e){var t=this,n=e.toUpperCase(),i="scroll"+n,o="boundryCheck"+n,r="_bounce"+e,a=t.boundry,s=t.userConfig.bounceSize||0;if(t[r]){var c="x"==e?a.left:a.top,l="x"==e?a.right:a.bottom,u="x"==e?t.containerWidth:t.containerHeight,f={zoomType:e,velocityX:0,velocityY:0,type:N};if(f["velocity"+n]=t[r],t.fire(N,f),t.userConfig.bounce){var d=t[r],h=.01*d/Math.abs(d),g=d/h,p=t.getOffset()[e]+g*d/2,y=100,C=150,_=0;p>c?(p>c+s&&(p=c+s),_=Math.abs(p-c)):l-u>p&&(l-u-s>p&&(p=l-u-s),_=Math.abs(l-u-p)),g=_/s*(C-y)+y,t[i](-p,g,"linear",function(){t[r]=0,t[o]()})}}else t[o]()},isBoundryOut:function(){return this.isBoundryOutLeft()||this.isBoundryOutRight()||this.isBoundryOutTop()||this.isBoundryOutBottom()},isBoundryOutLeft:function(){return-this.getOffsetLeft()<this.boundry.left},isBoundryOutRight:function(){return this.containerWidth+this.getOffsetLeft()<this.boundry.right},isBoundryOutTop:function(){return-this.getOffsetTop()<this.boundry.top},isBoundryOutBottom:function(){return this.containerHeight+this.getOffsetTop()<this.boundry.bottom},_bounce:function(e,t){var n=this,i=n.getOffset()[e],o=n.boundry,r="x"==e?o.left:o.top,a="x"==e?o.right:o.bottom,s="x"==e?n.containerWidth:n.containerHeight,c=a-r,l=n.userConfig,u={};if(0===t)return void("x"==e?n.boundryCheckX():n.boundryCheckY());if(!("x"==e&&n.userConfig.lockX||"y"==e&&n.userConfig.lockY)){var f=l.maxSpeed>0&&l.maxSpeed<6?l.maxSpeed:3;if(t>f&&(t=f),-f>t&&(t=-f),i>r||c-s>i){var d=l.BOUNDRY_CHECK_ACCELERATION*(t/Math.abs(t)),h=t/d,g=i+h*t/2;return u.offset=-g,u.duration=h,u}var d=n.SROLL_ACCELERATION*(t/Math.abs(t)),h=t/d,g=i/1+h*t/2;if(g>r){var p=r-i,y=(t-Math.sqrt(-2*d*p+t*t))/d;u.offset=-r,u.duration=y,u.easing="linear",n["_bounce"+e]=t-d*y,n._prevSpeed=0}else if(c-s>g){var p=c-s-i,y=(t+Math.sqrt(-2*d*p+t*t))/d;u.offset=s-c,u.duration=y,u.easing="linear",n["_bounce"+e]=t-d*y,n._prevSpeed=t-d*y}else u.offset=-g,u.duration=h,u.easing=n.userConfig.easing,u.status="normal",n["_bounce"+e]=0,n._prevSpeed=0;return n["isScrolling"+e.toUpperCase()]=!0,u}},_scrollHandler:function(e,t,n,i,o){var r=this,a=r.getOffset(),s="x"==o?["left","right"]:["top","bottom"],c=o.toUpperCase(),l="x"==o?r.content:r.container,f="none",d=function(t){r["isScrolling"+c]=!1;var i,l=r.getOffset();l[t.type]==r.boundry.top&&Math.abs(r["_bounce"+o])>0?i="x"==o?"left":"top":l[t.type]+r.containerHeight==r.boundry.bottom&&Math.abs(r["_bounce"+o])>0&&(i="x"==o?"right":"bottom");var u={offset:l,zoomType:t.type,type:C};i&&(u.boundryout=i),u["direction"+t.type.toUpperCase()]=e-a[t.type]<0?s[1]:s[0],r.fire(C,u),n&&n(t)};return r.userConfig.useTransition&&(f=t>0?[U," ",t/1e3,"s ",p.format(i)," 0s"].join(""):"none",l.style[P]=f,"x"==o?r.translateX(e):r.translateY(e)),r.timer[o]=r.timer[o]||new u,r.timer[o].reset({duration:t,easing:i}),r.timer[o].detach("run"),r.timer[o].on("run",function(t){var n={zoomType:o,offset:r.getOffset(),type:_};n["direction"+o.toUpperCase()]=e-a[o]<0?s[1]:s[0],r.userConfig.useTransition||("x"==o?r.translateX(t.percent*(e-a[o])+a[o]):r.translateY(t.percent*(e-a[o])+a[o])),r.fire(_,n)}),r.timer[o].detach("end"),r.timer[o].on("end",function(){r.userConfig.useTransition||d({type:o})}),r.timer[o].stop(),r.timer[o].run(),0>=t||e==a[o]?(r.fire(_,{zoomType:o,offset:a,type:_}),void r.fire(C,{zoomType:o,offset:a,type:C})):(r["isScrolling"+c]=!0,r.userConfig.useTransition&&(r["__scrollEndCallback"+c]=d),void r.fire(w,{transition:f,offset:{x:r.x,y:r.y},type:w,duration:t/1e3,easing:p.format(i),zoomType:o}))},addView:function(e,t){var n=this;return t=r.mix({captureBounce:!1,stopPropagation:!0},t),!e||!e instanceof y?void 0:(n.__subViews||(n.__subViews={}),e.guid&&!n.__subViews[e.guid]?(e.__viewControllers=e.__viewControllers||{},e.parentView={instance:n},e.__viewControllers.boundryout=function(e){n._scrollAnimate(e)},t.captureBounce&&e.on("boundryout",e.__viewControllers.boundryout),n.__subViews[e.guid]=e):void 0)},removeView:function(e){var t=this;if(e&&e.guid){var n=t.__subViews[e.guid];if(n){delete n.parentView;for(var i in n.__viewControllers)n.detach(i,n.__viewControllers[i]);n.__viewControllers={},delete n}}},getViews:function(e){return e?this.__subViews[e]:this.__subViews}}),"object"==typeof i&&i.exports?void(i.exports=y):window.XScroll=y});
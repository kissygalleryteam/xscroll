/*!build time : 2014-12-18 5:12:53 PM*/
KISSY.add("kg/xscroll/2.3.1/scrollbar",function(a,b){var c=60,d=8,e=b.prefixStyle("transform"),f=b.vendor?["-",b.vendor,"-transform"].join(""):"transform",g=b.prefixStyle("transition"),h=(b.prefixStyle("borderRadius"),b.prefixStyle("transitionDuration")),i=function(a){this.userConfig=a,this.init(a.xscroll)};return b.mix(i.prototype,{init:function(a){var b=this;b.xscroll=a,b.type=b.userConfig.type,b.isY="y"==b.type?!0:!1;var c=b.xscroll.boundry;b.containerSize=b.isY?b.xscroll.containerHeight+c._xtop+c._xbottom:b.xscroll.containerWidth+c._xright+c._xleft,b.indicateSize=b.isY?b.xscroll.height:b.xscroll.width,b.offset=b.xscroll.getOffset(),b.render(),b._bindEvt()},destroy:function(){var a=this;a.scrollbar&&a.scrollbar.remove(),a.xscroll.detach("scaleanimate",a._update,a),a.xscroll.detach("scrollend",a._update,a),a.xscroll.detach("scrollanimate",a._update,a),!a.xscroll.userConfig.useTransition&&a.xscroll.detach("scroll",a._update,a),delete a},render:function(){var a=this;if(!a.__isRender){a.__isRender=!0;var b=a.xscroll,c=b.userConfig.gpuAcceleration?" translateZ(0) ":"",d=c?f+":"+c+";":"",e=a.isY?"opacity:0;width: 3px;position:absolute;bottom:5px;top:5px;right:2px;z-index:999;overflow:hidden;-webkit-border-radius:2px;-moz-border-radius:2px;-o-border-radius:2px;"+d:"opacity:0;height:3px;position:absolute;left:5px;right:5px;bottom:2px;z-index:999;overflow:hidden;-webkit-border-radius:2px;-moz-border-radius:2px;-o-border-radius:2px;"+d;a.scrollbar=document.createElement("div"),a.scrollbar.style.cssText=e,b.renderTo.appendChild(a.scrollbar);var g=a.isY?"width:100%;":"height:100%;";a.indicate=document.createElement("div"),a.indicate.style.cssText=g+"position:absolute;background:rgba(0,0,0,0.3);-webkit-border-radius:2px;-moz-border-radius:2px;-o-border-radius:2px;",a.scrollbar.appendChild(a.indicate),a._update(),a.hide()}},_update:function(a,b,c){var d=this,a=a||d.xscroll.getOffset(),e=d.computeScrollBar(a),f=d.isY?"height":"width";d.indicate.style[f]=Math.round(e.size)+"px",b&&c?d.scrollTo(e.offset,b,c):d.moveTo(e.offset)},computeScrollBar:function(a){var b=this,e=b.isY?"y":"x",a=Math.round(a&&-a[e]),f=10,g=b.xscroll.boundry;b.containerSize=b.isY?b.xscroll.containerHeight+g._xtop+g._xbottom:b.xscroll.containerWidth+g._xright+g._xleft,b.size=b.isY?b.xscroll.height:b.xscroll.width,b.indicateSize=b.isY?b.xscroll.height-f:b.xscroll.width-f;var h=b.indicateSize,i=b.containerSize,j=i-b.size,k=a/i,l=h*k,m=Math.round(h*b.size/i),n=l*(h-c+m)/h;if(c>m&&(m=c,l=n),0>l)l=Math.abs(a)*m/c>m-d?d-m:a*m/c;else if(l+m>h&&a-j>0){var o=a-i+h+f;l=o*m/c>m-d?h+f-d:h+f-m+o*m/c}b.barOffset=Math.round(l);var p={size:Math.round(m)},o={};return o[e]=b.barOffset,p.offset=o,p},scrollTo:function(a,b,c){var d=this,f=d.xscroll.userConfig.gpuAcceleration?" translateZ(0) ":"";d.indicate.style[e]=d.isY?"translateY("+a.y+"px) "+f:"translateX("+a.x+"px) "+f,d.indicate.style[g]=["all ",b,"s ",c," 0"].join("")},moveTo:function(a){var c=this;c.show();var d=c.xscroll.userConfig.gpuAcceleration?" translateZ(0) ":"";c.indicate.style[e]=c.isY?"translateY("+a.y+"px) "+d:"translateX("+a.x+"px) "+d,b.isBadAndroid()?c.indicate.style[h]="0.001s":c.indicate.style[g]=""},_bindEvt:function(){var a=this;if(!a.__isEvtBind){a.__isEvtBind=!0;var b=a.isY?"y":"x",c=function(b){return"x"==b?a.xscroll.isBoundryOutLeft()&&a.xscroll.isBoundryOutRight():a.xscroll.isBoundryOutTop()&&a.xscroll.isBoundryOutBottom()};a.xscroll.userConfig.useTransition?(a.xscroll.on("pan",function(b){a._update(b.offset)}),a.xscroll.on("scrollanimate",function(c){c.zoomType==b&&a._update(c.offset,c.duration,c.easing)}),a.xscroll.on("scaleanimate",function(b){a._update(b.offset)})):a.xscroll.on("scroll",function(b){a._update(b.offset)}),a.xscroll.on("panend",function(d){Math.abs(0==d.velocity)&&!c(b)&&a.hide()}),a.xscroll.on("scrollend",function(d){d.zoomType.indexOf(b)>-1&&(a._update(d.offset),c(d.zoomType)||a.hide())})}},reset:function(){var a=this;a.offset={x:0,y:0},a._update()},hide:function(){var a=this;a.scrollbar.style.opacity=0,a.scrollbar.style[g]="opacity 0.3s ease-out .5s"},show:function(){var a=this;a.scrollbar.style.opacity=1,b.isBadAndroid()?a.scrollbar.style[h]="0.001s":a.scrollbar.style[g]=""}}),i},{requires:["./util"]});
define('kg/xscroll/2.3.0/pulldown',["./util","./base"],function(require, exports, module) {var n,t=require("./util"),e=require("./base"),o="Pull Down To Refresh",i="Loading...",s=function(n){s.superclass.constructor.call(this),this.userConfig=t.mix({content:o,height:60,autoRefresh:!0,downContent:"Pull Down To Refresh",upContent:"Release To Refresh",loadingContent:i,prefix:"xs-plugin-pulldown-"},n)};t.extend(s,e,{pluginId:"xscroll/plugin/pulldown",pluginInitializer:function(t){var e=this;e.xscroll=t,n=e.userConfig.prefix,e.xscroll&&e.xscroll.on("afterrender",function(){e.render()})},pluginDestructor:function(){var n=this;n.pulldown&&n.pulldown.remove(),n.xscroll.detach("panstart",n._panStartHandler,n),n.xscroll.detach("pan",n._panHandler,n),n.xscroll.detach("panend",n._panEndHandler,n),delete n},render:function(){var e=this;if(!e.__isRender){e.__isRender=!0;var o=n+"container",i=e.userConfig.height||60,s=e.pulldown=document.createElement("div");s.className=o,s.style.position="absolute",s.style.width="100%",s.style.height=i+"px",s.style.top=-i+"px",e.xscroll.container.appendChild(s),t.addClass(s,n+e.status),s.innerHTML=e.userConfig[e.status+"Content"]||e.userConfig.content,e._bindEvt()}},_bindEvt:function(){var n=this;if(!n._evtBinded){n._evtBinded=!0;var t=(n.pulldown,n.xscroll);t.on("pan",function(t){n._panHandler(t)}),t.on("panstart",function(t){n._panStartHandler(t)}),t.on("panend",function(t){n._panEndHandler(t)})}},_changeStatus:function(e){var o=this.status;this.status=e,t.removeClass(this.pulldown,n+o),t.addClass(this.pulldown,n+e),this.setContent(this.userConfig[e+"Content"]),o!=e&&(this.fire("statuschange",{prevVal:o,newVal:e}),"loading"==e&&this.fire("loading"))},reset:function(n){this.xscroll.boundry.resetTop(),this.xscroll.bounce(!0,n),this._expanded=!1},_panStartHandler:function(){clearTimeout(this.loadingItv)},_panHandler:function(n){var t=this,e=n.offset.y,o=t.userConfig.height||60;0>e||t._changeStatus(Math.abs(e)<o?"down":"up")},_panEndHandler:function(){var n=this,t=n.xscroll,e=n.userConfig.height||60,o=t.getOffsetTop();o>e&&(t.boundry.resetTop(),t.boundry.expandTop(e),t.bounce(!0,function(){n._changeStatus("loading")}),n.userConfig.autoRefresh&&(clearTimeout(n.loadingItv),n.loadingItv=setTimeout(function(){t.boundry.resetTop(),t.bounce(!0,function(){window.location.reload()})},800)))},setContent:function(n){var t=this;n&&(t.pulldown.innerHTML=n)}}),module.exports=s;});
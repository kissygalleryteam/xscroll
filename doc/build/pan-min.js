KISSY.add("kg/xscroll/2.3.2/pan",["./util","./event"],function(t,e,a,i){function o(t){if(!(t.touches.length>1||this.gestureType&&"pan"!=this.gestureType))if(""==this.gestureType&&(X=[]),X.length){if("pan"!=this.gestureType)return;p.deltaX=t.touches[0].clientX-p.startX,p.deltaY=t.touches[0].clientY-p.startY,p.directionX=t.touches[0].clientX-p.prevX>0?"right":"left",p.directionY=t.touches[0].clientY-p.prevY>0?"bottom":"top",p.prevX=t.touches[0].clientX,p.prevY=t.touches[0].clientY,t.touch=p,X.push({deltaX:p.deltaX,deltaY:p.deltaY,timeStamp:t.timeStamp}),t.deltaX=p.deltaX,t.deltaY=p.deltaY,t.velocityX=0,t.velocityY=0,t.directionX=p.directionX,t.directionY=p.directionY,n.dispatchEvent(t.target,d,t)}else p={},p.startX=t.touches[0].clientX,p.startY=t.touches[0].clientY,p.deltaX=0,p.deltaY=0,t.touch=p,p.prevX=p.startX,p.prevY=p.startY,X.push({deltaX:p.deltaX,deltaY:p.deltaY,timeStamp:t.timeStamp}),t.deltaX=p.deltaX,t.deltaY=p.deltaY,this.gestureType="pan",n.dispatchEvent(t.target,v,t)}function c(t){var e=0,a=0,i=0;if(!(t.touches.length>1)){p.deltaX=t.changedTouches[0].clientX-p.startX,p.deltaY=t.changedTouches[0].clientY-p.startY,t.deltaX=p.deltaX,t.deltaY=p.deltaY,t.touch=p,t.touch.record=X;var o=(t.touch.startX,t.touch.startY,X.length),c=X[0]&&X[0].timeStamp;if(!(2>o)&&c){{X[o-1].timeStamp-X[0].timeStamp}for(var v in X)v>0?(X[v].velocity=l(X[v].deltaX,X[v].deltaY,X[v-1].deltaX,X[v-1].deltaY)/(X[v].timeStamp-X[v-1].timeStamp),X[v].velocityX=(X[v].deltaX-X[v-1].deltaX)/(X[v].timeStamp-X[v-1].timeStamp),X[v].velocityY=(X[v].deltaY-X[v-1].deltaY)/(X[v].timeStamp-X[v-1].timeStamp)):(X[v].velocity=0,X[v].velocityX=0,X[v].velocityY=0);var d=X[0].velocityX/Math.abs(X[0].velocityX);for(var v in X)X[v].velocityX/Math.abs(X[v].velocityX)!=d&&(d=X[v].velocityX/Math.abs(X[v].velocityX),i=v);var h=X[0].velocityY/Math.abs(X[0].velocityY);for(var v in X)X[v].velocityY/Math.abs(X[v].velocityY)!=h&&(h=X[v].velocityY/Math.abs(X[v].velocityY),a=v);e=Math.max(i,a);{X[e]}t.touch.record=t.touch.record.splice(e-1);var u=r(t.touch.record);t.velocityX=Math.abs(u.velocityX)>Y?u.velocityX/Math.abs(u.velocityX)*Y:u.velocityX,t.velocityY=Math.abs(u.velocityY)>Y?u.velocityY/Math.abs(u.velocityY)*Y:u.velocityY,t.velocity=Math.sqrt(Math.pow(t.velocityX,2)+Math.pow(t.velocityY,2)),p={},X=[],"pan"==this.gestureType&&(n.dispatchEvent(t.target,s,t),this.gestureType="")}}}function l(t,e,a,i){return Math.sqrt(Math.pow(a-t,2)+Math.pow(i-e,2))}function r(t){for(var e=0,a=0,i=t.length,o=0;i>o;o++)e+=t[o].velocityY,a+=t[o].velocityX;return e/=i,a/=i,{velocityY:Math.abs(t[i-1].velocityY)>h?e:0,velocityX:Math.abs(t[i-1].velocityX)>h?a:0}}var n=(e("./util"),e("./event")),v=(window.document,n.prefix("panstart")),s=n.prefix("panend"),d=n.prefix("pan"),h=.35,Y=8,p={},X=[];document.addEventListener("touchmove",o),document.addEventListener("touchend",c);var u={PAN_START:v,PAN_END:s,PAN:d,reset:function(){X=[]}};return"object"==typeof i&&i.exports?void(i.exports=u):u});
/*!build time : 2014-12-18 5:12:53 PM*/
KISSY.add("kg/xscroll/2.3.1/pan",function(a,b,c){function d(a){if(!(a.touches.length>1||this.gestureType&&"pan"!=this.gestureType))if(""==this.gestureType&&(n=[]),n.length){if("pan"!=this.gestureType)return;m.deltaX=a.touches[0].clientX-m.startX,m.deltaY=a.touches[0].clientY-m.startY,m.directionX=a.touches[0].clientX-m.prevX>0?"right":"left",m.directionY=a.touches[0].clientY-m.prevY>0?"bottom":"top",m.prevX=a.touches[0].clientX,m.prevY=a.touches[0].clientY,a.touch=m,n.push({deltaX:m.deltaX,deltaY:m.deltaY,timeStamp:a.timeStamp}),a.deltaX=m.deltaX,a.deltaY=m.deltaY,a.velocityX=0,a.velocityY=0,a.directionX=m.directionX,a.directionY=m.directionY,c.dispatchEvent(a.target,j,a)}else m={},m.startX=a.touches[0].clientX,m.startY=a.touches[0].clientY,m.deltaX=0,m.deltaY=0,a.touch=m,m.prevX=m.startX,m.prevY=m.startY,n.push({deltaX:m.deltaX,deltaY:m.deltaY,timeStamp:a.timeStamp}),a.deltaX=m.deltaX,a.deltaY=m.deltaY,this.gestureType="pan",c.dispatchEvent(a.target,h,a)}function e(a){var b=0,d=0,e=0;if(!(a.touches.length>1)){m.deltaX=a.changedTouches[0].clientX-m.startX,m.deltaY=a.changedTouches[0].clientY-m.startY,a.deltaX=m.deltaX,a.deltaY=m.deltaY,a.touch=m,a.touch.record=n;var h=(a.touch.startX,a.touch.startY,n.length),j=n[0]&&n[0].timeStamp;if(!(2>h)&&j){{n[h-1].timeStamp-n[0].timeStamp}for(var k in n)k>0?(n[k].velocity=f(n[k].deltaX,n[k].deltaY,n[k-1].deltaX,n[k-1].deltaY)/(n[k].timeStamp-n[k-1].timeStamp),n[k].velocityX=(n[k].deltaX-n[k-1].deltaX)/(n[k].timeStamp-n[k-1].timeStamp),n[k].velocityY=(n[k].deltaY-n[k-1].deltaY)/(n[k].timeStamp-n[k-1].timeStamp)):(n[k].velocity=0,n[k].velocityX=0,n[k].velocityY=0);var o=n[0].velocityX/Math.abs(n[0].velocityX);for(var k in n)n[k].velocityX/Math.abs(n[k].velocityX)!=o&&(o=n[k].velocityX/Math.abs(n[k].velocityX),e=k);var p=n[0].velocityY/Math.abs(n[0].velocityY);for(var k in n)n[k].velocityY/Math.abs(n[k].velocityY)!=p&&(p=n[k].velocityY/Math.abs(n[k].velocityY),d=k);b=Math.max(e,d);{n[b]}a.touch.record=a.touch.record.splice(b-1);var q=g(a.touch.record);a.velocityX=Math.abs(q.velocityX)>l?q.velocityX/Math.abs(q.velocityX)*l:q.velocityX,a.velocityY=Math.abs(q.velocityY)>l?q.velocityY/Math.abs(q.velocityY)*l:q.velocityY,a.velocity=Math.sqrt(Math.pow(a.velocityX,2)+Math.pow(a.velocityY,2)),m={},n=[],"pan"==this.gestureType&&(c.dispatchEvent(a.target,i,a),this.gestureType="")}}}function f(a,b,c,d){return Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2))}function g(a){for(var b=0,c=0,d=a.length,e=0;d>e;e++)b+=a[e].velocityY,c+=a[e].velocityX;return b/=d,c/=d,{velocityY:Math.abs(a[d-1].velocityY)>k?b:0,velocityX:Math.abs(a[d-1].velocityX)>k?c:0}}var h=(window.document,c.prefix("panstart")),i=c.prefix("panend"),j=c.prefix("pan"),k=.35,l=8,m={},n=[];document.addEventListener("touchmove",d),document.addEventListener("touchend",e);var o={PAN_START:h,PAN_END:i,PAN:j};return o},{requires:["./util","./event"]});
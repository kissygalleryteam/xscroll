/*!build time : 2014-12-18 5:12:53 PM*/
KISSY.add("kg/xscroll/2.3.1/infinite",function(a,b,c,d,e,f,g){var h=b.prefixStyle("transform"),i=function(a){i.superclass.constructor.call(this,a)};return i.Util=b,i.Plugin={SwipeEdit:e,PullUp:f,PullDown:g},i.DataSet=d,b.extend(i,c,{init:function(){var a=this;i.superclass.init.call(this),a.userConfig=b.mix({data:[],itemWidth:40,zoomType:"y",itemHeight:40},a.userConfig),"x"==a.userConfig.zoomType?(a.userConfig.lockY=!0,a.userConfig.scrollbarY=!1):(a.userConfig.lockX=!0,a.userConfig.scrollbarX=!1),a.isY=!("y"!=a.userConfig.zoomType),a._nameTop=a.isY?"_top":"_left",a._nameHeight=a.isY?"_height":"_width",a._nameRow=a.isY?"_row":"_col",a.nameTop=a.isY?"top":"left",a.nameHeight=a.isY?"height":"width",a.nameRow=a.isY?"row":"col",a.nameY=a.isY?"y":"x",a.nameTranslate=a.isY?"translateY":"translateX",a.nameContainerHeight=a.isY?"containerHeight":"containerWidth",a._initInfinite()},_getDomInfo:function(){var a=this,b=0,c=[],d=0,e=a._formatData(),f=a.isY?a.userConfig.itemHeight:a.userConfig.itemWidth;a.hasSticky=!1,a.userConfig.maxSpeed=.06*f;for(var g=0,h=e.length;h>g;g++){var i=e[g];d=i.style&&i.style.height>=0?i.style.height:f,i[a._nameRow]=g,i[a._nameTop]=b,i[a._nameHeight]=d,i.recycled=i.recycled===!1?!1:!0,c.push(i),b+=d,!a.hasSticky&&i.style&&"sticky"==i.style.position&&(a.hasSticky=!0)}return a.domInfo=c,c},appendDataSet:function(a){var b=this;!a instanceof d||b.datasets.push(a)},removeDataSet:function(a){var b=this;if(a){for(var c,d=0,e=b.datasets.length;e>d;d++)a==b.datasets[d].getId()&&(c=d);b.datasets.splice(c,1)}},_fireTouchStart:function(a){var b=this,c=this.getCellByPagePos(b.isY?a.touches[0].pageY:a.touches[0].pageX);a.cell=c,b._curTouchedCell=c,i.superclass._fireTouchStart.call(b,a)},_firePanStart:function(a){var b=this,c=this.getCellByPagePos(b.isY?a.touch.startY:a.touch.startX);a.cell=c,b._curTouchedCell=c,i.superclass._firePanStart.call(b,a)},_firePan:function(a){this._curTouchedCell&&(a.cell=this._curTouchedCell),i.superclass._firePan.call(this,a)},_firePanEnd:function(a){this._curTouchedCell&&(a.cell=this._curTouchedCell),i.superclass._firePanEnd.call(this,a),this._curTouchedCell=null},_fireClick:function(a,b){var c=this,d=c.getCellByPagePos(c.isY?b.pageY:b.pageX);b.cell=d,i.superclass._fireClick.call(c,a,b)},getCellByPagePos:function(a){var c=this,d=c.isY?a-b.getOffsetTop(c.renderTo)+Math.abs(c.getOffsetTop()):a-b.getOffsetLeft(c.renderTo)+Math.abs(c.getOffsetLeft());return c.getCellByOffset(d)},getCellByRowOrCol:function(a){var b,c=this;if("number"==typeof a&&a<c.domInfo.length)for(var d=0;d<c.infiniteLength;d++)if(a==c.infiniteElementsCache[d][c._nameRow])return b=c.domInfo[c.infiniteElementsCache[d][c._nameRow]],b.element=c.infiniteElements[d],b},getCellByOffset:function(a){var b,c=this,d=c.domInfo.length;if(!(0>a))for(var e=0;d>e;e++)if(b=c.domInfo[e],b[c._nameTop]<a&&b[c._nameTop]+b[c._nameHeight]>a)return c.getCellByRowOrCol(e)},insertData:function(a,b,c){var d=this;return c&&a>=0&&d.datasets[a]&&b>=0?d.datasets[a].data=d.datasets[a].data.slice(0,b).concat(c).concat(d.datasets[a].data.slice(b)):void 0},getData:function(a,b){var c=this;return a>=0&&c.datasets[a]&&b>=0?c.datasets[a].getData(b):void 0},updateData:function(a,b,c){var d=this,e=d.getData(a,b);return e.data=c},removeData:function(a,b){var c=this;return a>=0&&c.datasets[a]&&b>=0?c.datasets[a].removeData(b):void 0},getDataSets:function(){var a=this;return a.datasets},getDataSetById:function(a){var b=this;if(a)for(var c=0,d=b.datasets.length;d>c;c++)if(b.datasets[c].getId()==a)return b.datasets[c]},_formatData:function(){var a=this,b=[];for(var c in a.datasets)b=b.concat(a.datasets[c].getData());return b},_getChangedRows:function(a,b){var c=this,d={};for(var e in c.elementsPos)a.hasOwnProperty(e)||(d[e]="delete");for(var e in a)!a[e].recycled||c.elementsPos.hasOwnProperty(e)&&!b||(d[e]="add");return c.elementsPos=a,d},_getElementsPos:function(a){for(var b,c=this,d=c.domInfo,a=-(a||(c.isY?c.getOffsetTop():c.getOffsetLeft())),e=c.isY?c.userConfig.itemHeight:c.userConfig.itemWidth,f=Math.ceil(c.isY?c.height/e:c.width/e),g=void 0===c.userConfig.maxBufferedNum?Math.max(Math.ceil(f/3),1):c.userConfig.maxBufferedNum,h=Math.max(a-g*e,0),i={},j=0,k=d.length;k>j;j++)b=d[j],b[c._nameTop]>=h-e&&b[c._nameTop]<=h+2*g*e+(c.isY?c.height:c.width)&&(i[b[c._nameRow]]=b);return i},render:function(){var a=this;i.superclass.render.call(this),a._getDomInfo(),a._initSticky();var b=a[a.nameHeight],c=a.domInfo[a.domInfo.length-1],d=c&&void 0!==c[a._nameTop]?c[a._nameTop]+c[a._nameHeight]:a[a.nameHeight];b>d&&(d=b),a[a.nameContainerHeight]=d,a.container.style[a.nameHeight]=d+"px",a.renderScrollBars(),a._renderNoRecycledEl(),a._update(a.isY?a.getOffsetTop():a.getOffsetLeft(),!0)},_update:function(a,b){var c=this,d=c.userConfig.gpuAcceleration?" translateZ(0) ":"",a=void 0===a?c.isY?c.getOffsetTop():c.getOffsetLeft():a,e=c._getElementsPos(a),f=c._getChangedRows(e,b),g=null;if(b)for(var i=0;i<c.infiniteLength;i++)c.infiniteElementsCache[i]._visible=!1,c.infiniteElements[i].style.visibility="hidden",delete c.infiniteElementsCache[i][c._nameRow];var j=function(){for(var a=0;a<c.infiniteLength;a++)if(!c.infiniteElementsCache[a]._visible)return c.infiniteElementsCache[a]._visible=!0,a},k=function(a){for(var b=0;b<c.infiniteLength;b++)c.infiniteElementsCache[b][c._nameRow]==a&&(c.infiniteElementsCache[b]._visible=!1,c.infiniteElements[b].style.visibility="hidden",delete c.infiniteElementsCache[b][c._nameRow])};for(var i in f)if("delete"==f[i]&&k(i),"add"==f[i]){var l=j(e[i][c._nameRow]);if(g=c.infiniteElements[l]){c.infiniteElementsCache[l][c._nameRow]=e[i][c._nameRow];for(var m in e[i].style)m!=c.nameHeight&&"display"!=m&&"position"!=m&&(g.style[m]=e[i].style[m]);g.style.visibility="visible",g.style[c.nameHeight]=e[i][c._nameHeight]+"px",g.style[h]=c.nameTranslate+"("+e[i][c._nameTop]+"px) "+d,c.userConfig.renderHook.call(c,g,e[i])}}},_renderNoRecycledEl:function(){var a=this,b=a.userConfig.gpuAcceleration?" translateZ(0) ":"";for(var c in a.domInfo)if(a.domInfo[c].recycled===!1){var d=a.domInfo[c].id&&document.getElementById(a.domInfo[c].id.replace("#",""))||document.createElement("div"),e="xs-row-"+Date.now();d.id=a.domInfo[c].id||e,a.domInfo[c].id=d.id,a.content.appendChild(d);for(var f in a.domInfo[c].style)f!=a.nameHeight&&"display"!=f&&"position"!=f&&(d.style[f]=a.domInfo[c].style[f]);d.style[a.nameTop]=0,d.style.position="absolute",d.style.display="block",d.style[a.nameHeight]=a.domInfo[c][a._nameHeight]+"px",d.style[h]=a.nameTranslate+"("+a.domInfo[c][a._nameTop]+"px) "+b,a.domInfo[c].className&&(d.className=a.domInfo[c].className),a.userConfig.renderHook.call(a,d,a.domInfo[c])}},_initSticky:function(){var a=this;if(a.hasSticky){if(!a._isStickyRendered){var b=document.createElement("div");b.style.position="absolute",b.style[a.nameTop]="0",b.style.display="none",a.renderTo.appendChild(b),a.stickyElement=b,a._isStickyRendered=!0}a.stickyDomInfo=[];for(var c=0,d=a.domInfo.length;d>c;c++)a.domInfo[c]&&a.domInfo[c].style&&"sticky"==a.domInfo[c].style.position&&a.stickyDomInfo.push(a.domInfo[c]);a.stickyDomInfoLength=a.stickyDomInfo.length}},_stickyHandler:function(a){var b=this;if(b.stickyDomInfoLength){for(var c=Math.abs(a),d=[],e=[],f=0;f<b.stickyDomInfoLength;f++)e.push(b.stickyDomInfo[f][b._nameTop]),c>=b.stickyDomInfo[f][b._nameTop]&&d.push(f);if(!d.length)return b.stickyElement.style.display="none",void(b.curStickyIndex=void 0);var g=Math.max.apply(null,d);if(b.curStickyIndex!==g){b.curStickyIndex=g,b.userConfig.renderHook.call(b,b.stickyElement,b.stickyDomInfo[b.curStickyIndex]),b.stickyElement.style.display="block",b.stickyElement.style[b.nameHeight]=b.stickyDomInfo[b.curStickyIndex].style[b.nameHeight]+"px",b.stickyElement.className=b.stickyDomInfo[b.curStickyIndex].className||"";for(var h in b.stickyDomInfo[b.curStickyIndex].style)h!=b.nameHeight&&"display"!=h&&"position"!=h&&(b.stickyElement.style[h]=b.stickyDomInfo[b.curStickyIndex].style[h])}return-a<Math.min.apply(null,e)?(b.stickyElement.style.display="none",void(b.curStickyIndex=void 0)):void 0}},enableGPUAcceleration:function(){var a=this;i.superclass.enableGPUAcceleration.call(a);for(var b=0;b<a.infiniteLength;b++)/translateZ/.test(a.infiniteElements[b].style[h])||(a.infiniteElements[b].style[h]+=" translateZ(0)")},disableGPUAcceleration:function(){var a=this;i.superclass.disableGPUAcceleration.call(a);for(var b=0;b<a.infiniteLength;b++)a.infiniteElements[b].style[h]=a.infiniteElements[b].style[h].replace(/translateZ\(0px\)/,"")},_initInfinite:function(){var a=this,b=a.userConfig.infiniteElements;a.datasets=[],a.userConfig.data&&a.userConfig.data.length&&a.datasets.push(new d({data:a.userConfig.data})),a.infiniteElements=a.renderTo.querySelectorAll(b),a.infiniteLength=a.infiniteElements.length,a.infiniteElementsCache=function(){for(var b=[],c=0;c<a.infiniteLength;c++)b.push({}),a.infiniteElements[c].style.position="absolute",a.infiniteElements[c].style[a.nameTop]=0,a.infiniteElements[c].style.visibility="hidden",a.infiniteElements[c].style.display="block";return b}(),a.elementsPos={},a.on("scroll",function(b){a._update(b.offset[a.nameY]),a._stickyHandler(b.offset[a.nameY])})}}),i},{requires:["./util","./core","./dataset","./swipeedit","./pullup","./pulldown"]});
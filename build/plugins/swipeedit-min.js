KISSY.add("kg/xscroll/3.0.0/plugins/swipeedit",["../util","../base"],function(e,t,l,n){var i,r=t("../util"),s=t("../base"),o=r.prefixStyle("transform"),a=r.prefixStyle("transition"),c="xs-plugin-swipeedit-",d=!1,f=20,u=!1,g=!1,h=r.vendor?["-",r.vendor,"-transform"].join(""):"transform",p=1,w=function(e){w.superclass.constructor.call(this),this.userConfig=r.mix({labelSelector:c+"label",renderHook:function(e){e.innerHTML=tpl}},e)};if(r.extend(w,s,{pluginId:"swipeedit",pluginInitializer:function(e){var t=this;t.xscroll=e,t.xscroll.on("aftereventbind",function(){t._bindEvt()})},pluginDestructor:function(){},getTransformX:function(e){if(!e)return"";var t=getComputedStyle(e)[o].match(/[-\d\.*\d*]+/g);return t?t[4]/1:0},_bindEvt:function(){var e=this,t=e.xscroll,l=e.xscroll.mc,n=null;l.on("panstart",function(t){g=!1,t.cell&&t.cell.element&&(n=t.cell.element.querySelector(e.userConfig.labelSelector),n&&(i=e.getTransformX(n),n.style[a]="none",Math.abs(i)>0&&!u&&e.slideRight(t)))}),l.on("pan",function(l){if(n)if("left"==l.touch.directionX&&e.slideAllExceptRow(l.cell._row),Math.abs(l.deltaY)<10&&Math.abs(l.deltaX)/Math.abs(l.deltaY)>4&&Math.abs(l.deltaX)>f){d=!0,t.userConfig.lockY=!0;var r=i+l.deltaX+f;if(r>0)return;n.style[a]="none",n.style[o]="translateX("+r+"px)"}else d||(t.userConfig.lockY=!1)}),l.on("panend",function(t){if(n){d=!1;var l=e.getTransformX(n);"left"==t.touch.directionX&&Math.abs(t.velocityX)>p?e.slideLeftHandler(t):Math.abs(l)<e.userConfig.width/2?e.slideRightHandler(t):Math.abs(l)>=e.userConfig.width/2&&e.slideLeftHandler(t)}}),document.body.addEventListener("webkitTransitionEnd",function(t){new RegExp(e.userConfig.labelSelector.replace(/\./,"")).test(t.target.className)&&(u=!1)})},slideLeft:function(e){var t=this,l=t.xscroll,n=l.getCellByRowOrCol(e);if(n&&n.element){var i=n.element.querySelector(t.userConfig.labelSelector);i&&i.style&&(i.style[o]="translateX(-"+t.userConfig.width+"px) ",i.style[a]=h+" 0.15s ease",l.getData(0,e).data.status="delete")}},slideRight:function(e){var t=this,l=t.xscroll,n=l.getCellByRowOrCol(e);if(n&&n.element){var i=n.element.querySelector(t.userConfig.labelSelector);if(i&&i.style){var r=window.getComputedStyle(i)[o].match(/[-\d\.*\d*]+/g),s=r?Math.round(r[4]):0;0!=s&&(i.style[o]="translateX(0)",i.style[a]=h+" 0.5s ease",l.getData(0,e).data.status="")}}},slideLeftHandler:function(e){var t=this;u=!0,t.slideLeft(e.cell._row)},slideRightHandler:function(e){var t=this;g=!0,u=!0,t.slideRight(e.cell._row)},slideAllExceptRow:function(e){var t=this,l=t.xscroll;for(var n in l.infiniteElementsCache)(e!=l.infiniteElementsCache[n]._row||void 0===e)&&t.slideRight(l.infiniteElementsCache[n]._row)}}),"object"==typeof n&&n.exports)n.exports=w;else if(window.XScroll&&window.XScroll.Plugins)return XScroll.Plugins.SwipeEdit=w});
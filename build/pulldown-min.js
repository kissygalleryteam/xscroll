KISSY.add("kg/xscroll/2.3.2/pulldown",["./util","./base"],function(n,t,e,o){var i,s=t("./util"),l=t("./base"),a="Pull Down To Refresh",r="Loading...",u=function(n){u.superclass.constructor.call(this),this.userConfig=s.mix({content:a,height:60,autoRefresh:!0,downContent:"Pull Down To Refresh",upContent:"Release To Refresh",loadingContent:r,prefix:"xs-plugin-pulldown-"},n)};return s.extend(u,l,{pluginId:"xscroll/plugin/pulldown",pluginInitializer:function(n){var t=this;t.xscroll=n,i=t.userConfig.prefix,t.xscroll&&t.xscroll.on("afterrender",function(){t.render()})},pluginDestructor:function(){var n=this;n.pulldown&&n.pulldown.remove(),n.xscroll.detach("panstart",n._panStartHandler,n),n.xscroll.detach("pan",n._panHandler,n),n.xscroll.detach("panend",n._panEndHandler,n),delete n},render:function(){var n=this;if(!n.__isRender){n.__isRender=!0;var t=i+"container",e=n.userConfig.height||60,o=n.pulldown=document.createElement("div");o.className=t,o.style.position="absolute",o.style.width="100%",o.style.height=e+"px",o.style.top=-e+"px",n.xscroll.container.appendChild(o),s.addClass(o,i+n.status),o.innerHTML=n.userConfig[n.status+"Content"]||n.userConfig.content,n._bindEvt()}},_bindEvt:function(){var n=this;if(!n._evtBinded){n._evtBinded=!0;var t=(n.pulldown,n.xscroll);t.on("pan",function(t){n._panHandler(t)}),t.on("panstart",function(t){n._panStartHandler(t)}),t.on("panend",function(t){n._panEndHandler(t)})}},_changeStatus:function(n){var t=this.status;this.status=n,s.removeClass(this.pulldown,i+t),s.addClass(this.pulldown,i+n),this.setContent(this.userConfig[n+"Content"]),t!=n&&(this.fire("statuschange",{prevVal:t,newVal:n}),"loading"==n&&this.fire("loading"))},reset:function(n){this.xscroll.boundry.resetTop(),this.xscroll.bounce(!0,n),this._expanded=!1},_panStartHandler:function(){clearTimeout(this.loadingItv)},_panHandler:function(n){var t=this,e=n.offset.y,o=t.userConfig.height||60;0>e||t._changeStatus(Math.abs(e)<o?"down":"up")},_panEndHandler:function(n){var t=this,e=t.xscroll,o=t.userConfig.height||60,i=e.getOffsetTop();i>o&&(n.preventDefault(),e.boundry.resetTop(),e.boundry.expandTop(o),e.bounce(!0,function(){t._changeStatus("loading")}),t.userConfig.autoRefresh&&(clearTimeout(t.loadingItv),t.loadingItv=setTimeout(function(){e.boundry.resetTop(),e.bounce(!0,function(){window.location.reload()})},800)))},setContent:function(n){var t=this;n&&(t.pulldown.innerHTML=n)}}),"object"==typeof o&&o.exports?void(o.exports=u):u});
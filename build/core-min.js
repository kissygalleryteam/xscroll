/*!build time : 2014-12-18 5:12:53 PM*/
KISSY.add("kg/xscroll/2.3.1/core",function(a,b,c,d,e,f,g,h,i,j,k,l,m){var n=function(a){n.superclass.constructor.call(this),this.userConfig=a,this.init()};n.Util=c,n.Plugin={PullDown:j,PullUp:k};var o="scrollend",p="scroll",q="panend",r="panstart",s="pan",t="pinchstart",u="pinch",v="pinchend",w="scrollanimate",x="scaleanimate",y="scale",z="scaleend",A="afterrender",B="refresh",C=.001,D=400,E="ease",F=.1,G=.36,H=300,I=c.prefixStyle("transform"),J=c.prefixStyle("transition"),K=c.prefixStyle("transitionDuration"),L=c.prefixStyle("transformOrigin"),M=c.vendor?c.prefixStyle("transitionEnd"):"transitionend",N=c.vendor?["-",c.vendor,"-transform"].join(""):"transform",O=function(a,b){if(!(a.touches.length>1)){var c=a.changedTouches,d=c[0],e=document.createEvent("MouseEvent");e.initMouseEvent(b,!0,!0,window,1,d.screenX,d.screenY,d.clientX,d.clientY,!1,!1,!1,!1,0,null),a.target.dispatchEvent(e)}};return c.extend(n,b,{version:"2.3.1",init:function(){var a=this,b=a.userConfig=c.mix({snap:!1,snapWidth:100,snapHeight:100,snapRowIndex:0,snapColIndex:0,snapEasing:"ease",snapDuration:500,snapColsNum:1,snapRowsNum:1,bounce:!0,bounceDirections:["top","right","bottom","left"],scalable:!1,scrollbarX:!0,scrollbarY:!0,bounceSize:100,useTransition:!0,gpuAcceleration:!0,BOUNDRY_CHECK_EASING:E,BOUNDRY_CHECK_DURATION:D,BOUNDRY_CHECK_ACCELERATION:F,easing:"quadratic"},a.userConfig,void 0,void 0,!0);a.guid=c.guid(),a.renderTo=b.renderTo.nodeType?b.renderTo:document.querySelector(b.renderTo),a.scale=b.scale||1,a.timer={},a.boundryCheckEnabled=!0;var d=a.clsPrefix=b.clsPrefix||"xs-";a.SROLL_ACCELERATION=b.SROLL_ACCELERATION||C,a.containerClsName=d+"container",a.contentClsName=d+"content",a.boundry=new l,a.boundry.refresh()},refresh:function(){var a=this;a.render(),a.scrollTo({x:0,y:0}),a.fire(B,{type:B})},render:function(){var a=this,b=a.userConfig;a._createContainer();var c=b.width||a.renderTo.offsetWidth,d=b.height||a.renderTo.offsetHeight||0;a.width=c,a.height=d;var e=b.containerWidth||a.content.offsetWidth,f=b.containerHeight||a.content.offsetHeight;a.containerWidth=e<a.width?a.width:e,a.containerHeight=f<a.height?a.height:f,a.initialContainerWidth=a.containerWidth,a.initialContainerHeight=a.containerHeight;var g=a.userConfig.minScale||Math.max(a.width/a.containerWidth,a.height/a.containerHeight),h=a.userConfig.maxScale||1;a.minScale=g,a.maxScale=h,a.boundry.refresh({width:a.scale*a.width,height:a.scale*a.height}),a.fire(A),a.renderScrollBars(),a.userConfig.snap&&a.initSnap(),a._bindEvt()},renderScrollBars:function(){var a=this;a.userConfig.scrollbarX&&(a.scrollbarX=a.scrollbarX||new i({xscroll:a,type:"x"}),a.scrollbarX._update(),a.scrollbarX.hide()),a.userConfig.scrollbarY&&(a.scrollbarY=a.scrollbarY||new i({xscroll:a,type:"y"}),a.scrollbarY._update(),a.scrollbarY.hide())},_createContainer:function(){var a=this;if(!a.__isContainerCreated){var b=(a.renderTo,a.container=a.renderTo.getElementsByClassName(a.containerClsName)[0]),c=a.content=a.renderTo.getElementsByClassName(a.contentClsName)[0];b.style.position="absolute",b.style.height="100%",b.style.width="100%",b.style[L]="0 0",c.style.position="absolute",c.style[L]="0 0",a.translate({x:0,y:0}),a.__isContainerCreated=!0}},translate:function(a){this.translateX(a.x),this.translateY(a.y)},_scale:function(a,b,c){var d=this;if(d.userConfig.scalable&&d.scale!=a&&a){d.isScaling||(d.scaleBegin=d.scale,d.isScaling=!0,d.scaleBeginX=d.x,d.scaleBeginY=d.y),b&&(d.originX=b),c&&(d.originY=c);var e=d.boundry,f=a*d.initialContainerWidth,g=a*d.initialContainerHeight;d.containerWidth=Math.round(f>d.width?f:d.width),d.containerHeight=Math.round(g>d.height?g:d.height),d.scale=a;var h=b*(d.initialContainerWidth*d.scaleBegin-d.containerWidth)+d.scaleBeginX,i=c*(d.initialContainerHeight*d.scaleBegin-d.containerHeight)+d.scaleBeginY;h>e.left&&(h=e.left),i>e.top&&(i=e.top),h<e.right-d.containerWidth&&(h=e.right-d.containerWidth),i<e.bottom-d.containerHeight&&(i=e.bottom-d.containerHeight),d.x=h,d.y=i,d._transform(),d._noTransition()}},scaleTo:function(a,b,c,d,e){var f=this;if(f.userConfig.scalable&&f.scale!=a&&a){var d=d||1,e=e||"ease-out",g=[N," ",d/1e3,"s ",e," 0s"].join(""),i=f.scale;f.timer.scale=f.timer.scale||new h,f.timer.scale.reset({duration:d}),f.timer.scale.detach("run"),f.timer.scale.on("run",function(d){var e=(a-i)*d.percent+i;f.fire(y,{type:y,scale:e,origin:{x:b,y:c}}),f.userConfig.useTransition||f._scale(e,b,c)}),f.timer.scale.detach("end"),f.timer.scale.on("end",function(){f.isScaling=!1,f.fire(z,{type:z,scale:f.scale,origin:{x:b,y:c}})}),f.userConfig.useTransition&&(f._scale(a,b,c),f.container.style[J]=g,f.content.style[J]=g),f.timer.scale.run(),f.fire(x,{scale:f.scale,duration:d,easing:e,offset:{x:f.x,y:f.y},origin:{x:b,y:c}})}},translateX:function(a){this.x=a,this._transform()},translateY:function(a){this.y=a,this._transform()},_noTransition:function(){var a=this;c.isBadAndroid()?(a.content.style[K]="0.001s",a.container.style[K]="0.001s"):(a.content.style[J]="none",a.container.style[J]="none")},stop:function(){var a=this;if(!a.isScaling){var b=a.boundry,c=a.getOffset();if(!(c.y>b.top||c.y+a.containerHeight<b.bottom||c.x>b.left||c.x+a.containerWidth<b.right)){a.userConfig.useTransition&&(a.translate(c),a._noTransition());for(var d in a.timer)a.timer[d].stop();a._bouncex=0,a._bouncey=0,a.fire(o,{type:o,offset:c,scale:a.scale,zoomType:"xy"})}}},enableGPUAcceleration:function(){this.userConfig.gpuAcceleration=!0},disableGPUAcceleration:function(){this.userConfig.gpuAcceleration=!1},_transform:function(){var a=this.userConfig.gpuAcceleration?" translateZ(0) ":"",b=this.userConfig.scalable?" scale("+this.scale+") ":"";this.content.style[I]="translate("+this.x+"px,0px) "+b+a,this.userConfig.lockY||(this.container.style[I]="translate(0px,"+this.y+"px) "+a)},getOffset:function(){var a=this;return{x:a.getOffsetLeft(),y:a.getOffsetTop()}},getOffsetTop:function(){if(this.lockY)return 0;var a=window.getComputedStyle(this.container)[I].match(/[-\d\.*\d*]+/g);return a?Math.round(a[5]):0},getOffsetLeft:function(){if(this.lockX)return 0;var a=window.getComputedStyle(this.content)[I].match(/[-\d\.*\d*]+/g);return a?Math.round(a[4]):0},scrollTo:function(a,b,c,d){var e=this,f=e.getOffset(),g=void 0===a.x||isNaN(a.x)?-f.x:a.x,h=void 0===a.y||isNaN(a.y)?-f.y:a.y;e.scrollX(g,b,c,d),e.scrollY(h,b,c,d)},scrollBy:function(a,b,c,d){var e=this;e.scrollByX(a.x,b,c,d),e.scrollByY(a.y,b,c,d)},scrollByX:function(a,b,c,d){var e=this,f=-e.getOffsetLeft();e.scrollX(Number(a)+Number(f),b,c,d)},scrollByY:function(a,b,c,d){var e=this,f=-e.getOffsetTop();e.scrollY(Number(a)+Number(f),b,c,d)},scrollX:function(a,b,c,d){var e=this,a=Math.round(a);if(!e.userConfig.lockX){var b=b||0,c=c||e.userConfig.easing;e._scrollHandler(-a,b,d,c,"x")}},scrollY:function(a,b,c,d){var e=this,a=Math.round(a);if(!e.userConfig.lockY){var b=b||0,c=c||e.userConfig.easing;e._scrollHandler(-a,b,d,c,"y")}},_scrollHandler:function(a,b,c,d,e){var f=this,g=f.getOffset(),i="x"==e?["left","right"]:["top","bottom"],j=e.toUpperCase(),k="x"==e?f.content:f.container,l="none",n=function(b){f["isScrolling"+j]=!1;var d,h=f.getOffset();h[b.type]==f.boundry.top&&Math.abs(f["_bounce"+e])>0?d="x"==e?"left":"top":h[b.type]+f.containerHeight==f.boundry.bottom&&Math.abs(f["_bounce"+e])>0&&(d="x"==e?"right":"bottom");var k={offset:h,zoomType:b.type,type:o};d&&(k.boundryout=d),k["direction"+b.type.toUpperCase()]=a-g[b.type]<0?i[1]:i[0],f.fire(o,k),c&&c(b)};return f.userConfig.useTransition&&(l=b>0?[N," ",b/1e3,"s ",m.format(d)," 0s"].join(""):"none",k.style[J]=l,"x"==e?f.translateX(a):f.translateY(a)),f.timer[e]=f.timer[e]||new h,f.timer[e].reset({duration:b,easing:d}),f.timer[e].detach("run"),f.timer[e].on("run",function(b){var c={zoomType:e,offset:f.getOffset(),type:p};c["direction"+e.toUpperCase()]=a-g[e]<0?i[1]:i[0],f.userConfig.useTransition||("x"==e?f.translateX(b.percent*(a-g[e])+g[e]):f.translateY(b.percent*(a-g[e])+g[e])),f.fire(p,c)}),f.timer[e].detach("end"),f.timer[e].on("end",function(){f.userConfig.useTransition||n({type:e})}),f.timer[e].stop(),f.timer[e].run(),0>=b||a==g[e]?(f.fire(p,{zoomType:e,offset:g,type:p}),void f.fire(o,{zoomType:e,offset:g,type:o})):(f["isScrolling"+j]=!0,f.userConfig.useTransition&&(f["__scrollEndCallback"+j]=n),void f.fire(w,{transition:l,offset:{x:f.x,y:f.y},type:w,duration:b/1e3,easing:m.format(d),zoomType:e}))},boundryCheckX:function(a){var b=this;if(b.boundryCheckEnabled&&!b.userConfig.lockX){var c=b.getOffset(),d=b.containerWidth,e=b.boundry;c.x>e.left?(c.x=e.left,b.scrollX(-c.x,b.userConfig.BOUNDRY_CHECK_DURATION,b.userConfig.BOUNDRY_CHECK_EASING,a)):c.x+d<e.right&&(c.x=e.right-d,b.scrollX(-c.x,b.userConfig.BOUNDRY_CHECK_DURATION,b.userConfig.BOUNDRY_CHECK_EASING,a))}},boundryCheckY:function(a){var b=this;if(b.boundryCheckEnabled&&!b.userConfig.lockY){var c=b.getOffset(),d=b.containerHeight,e=b.boundry;c.y>e.top?(c.y=e.top,b.scrollY(-c.y,D,E,a)):c.y+d<e.bottom&&(c.y=e.bottom-d,b.scrollY(-c.y,D,E,a))}},boundryCheck:function(a){this.boundryCheckX(a),this.boundryCheckY(a)},bounce:function(a,b){this.boundryCheckEnabled=a,a?this.boundryCheck(b):void 0},_fireTouchStart:function(a){this.fire("touchstart",a)},_firePanStart:function(a){this.fire(r,a)},_firePan:function(a){this.fire(s,a)},_firePanEnd:function(a){this.fire(q,a)},_fireClick:function(a,b){this.fire(a,b)},__handlers:{touchstart:function(a){var b=this;a.preventDefault(),b._fireTouchStart(a),(b.isScrollingX||b.isScrollingY)&&b.stop()},tap:function(a){var b=this;if(b._fireClick("click",a),b.isScrollingX||b.isScrollingY)b.isScrollingX=!1,b.isScrollingY=!1;else if(c.isBadAndroid()&&"a"==a.target.tagName.toLowerCase()){var d=a.target.getAttribute("href");d&&(location.href=d)}else O(a,"click")},panstart:function(a){var b=this;b._prevSpeed=0;{var d=b.offset=b.getOffset();b.boundry,b.containerWidth,b.containerHeight,b.boundry}return b.translate(d),b._firePanStart(c.mix(a,{offset:d})),d},pan:function(a){var b=this,d=b.boundry,e=b.userConfig.lockY?Number(b.offset.y):Number(b.offset.y)+a.deltaY,f=b.userConfig.lockX?Number(b.offset.x):Number(b.offset.x)+a.deltaX,g=b.userConfig.bounce,h=b.containerWidth,i=b.containerHeight;e>d.top&&(e=g||xscroll.getPlugin("xscroll/plugin/pulldown")?(e-d.top)*G+d.top:d.top),e<d.bottom-i&&(e=g?e+(d.bottom-i-e)*G:d.bottom-i),f>d.left&&(f=g?(f-d.left)*G+d.left:d.left),f<d.right-h&&(f=g?f+(d.right-h-f)*G:d.right-h),b.translate({x:f,y:e}),b._noTransition(),b.isScrollingX=!1,b.isScrollingY=!1,b.directionX="left"==a.directionX?"right":"right"==a.directionX?"left":"",b.directionY="top"==a.directionY?"bottom":"bottom"==a.directionY?"top":"",b._firePan(c.mix(a,{offset:{x:f,y:e},directionX:a.directionX,directionY:a.directionY,triggerType:s})),b.fire(p,c.mix(a,{offset:{x:f,y:e},directionX:b.directionX,directionY:b.directionY,triggerType:s}))},panend:function(a){{var b=this;b.getOffset(),b.boundry}b._firePanEnd(a),b.userConfig.snap?b._snapAnimate(a):b._scrollAnimate(a),delete b.offset}},_bindEvt:function(){var a=this;if(!a.__isEvtBind){a.__isEvtBind=!0;{var b=a.renderTo,h=a.container,i=a.content;a.containerWidth,a.containerHeight}if(c.isBadAndroid()&&d.on(b,"click",function(a){"a"==a.target.tagName.toLowerCase()&&a.preventDefault()}),d.on(b,"touchstart",function(b){a.__handlers.touchstart.call(a,b)}).on(b,f.TAP,function(b){a.__handlers.tap.call(a,b)}).on(b,e.PAN_START,function(b){a.__handlers.panstart.call(a,b)}).on(b,e.PAN,function(b){a.__handlers.pan.call(a,b)}).on(b,e.PAN_END,function(b){a.__handlers.panend.call(a,b)}),a.userConfig.useTransition&&d.on(h,M,function(b){b.elapsedTime.toFixed(3)<=.001||(b.target!=i||a.isScaling||a.__scrollEndCallbackX&&a.__scrollEndCallbackX({type:"x"}),b.target!=h||a.isScaling||a.__scrollEndCallbackY&&a.__scrollEndCallbackY({type:"y"}))},!1),a.userConfig.scalable){var j,k;g.init(),d.on(b,g.PINCH_START,function(b){scale=a.scale,j=(b.origin.pageX-a.x)/a.containerWidth,k=(b.origin.pageY-a.y)/a.containerHeight,a.fire(t,{scale:scale,origin:{x:j,y:k}})}),d.on(b,g.PINCH,function(b){var c=scale*b.scale;c<=a.userConfig.minScale&&(c=.5*a.userConfig.minScale*Math.pow(2,c/a.userConfig.minScale)),c>=a.userConfig.maxScale&&(c=2*a.userConfig.maxScale*Math.pow(.5,a.userConfig.maxScale/c)),a._scale(c,j,k),a.fire(u,{scale:c,origin:{x:j,y:k}})}),d.on(b,g.PINCH_END,function(){a.isScaling=!1,a.scale<a.minScale?a.scaleTo(a.minScale,j,k,H):a.scale>a.maxScale&&a.scaleTo(a.maxScale,j,k,H),a.fire(v,{scale:scale,origin:{x:j,y:k}})}),d.on(b,f.DOUBLE_TAP,function(b){j=(b.pageX-a.x)/a.containerWidth,k=(b.pageY-a.y)/a.containerHeight,a.scale>a.minScale?a.scaleTo(a.minScale,j,k,200):a.scaleTo(a.maxScale,j,k,200)})}d.on(window,"resize",function(){a.refresh()})}},initSnap:function(){var a=this;a.snapRowIndex=a.userConfig.snapRowIndex,a.snapColIndex=a.userConfig.snapColIndex},snapTo:function(a,b,c){var d=this,e=d.userConfig,f=e.snapWidth,g=e.snapHeight,h=e.snapColsNum,i=e.snapRowsNum;a=a>=h?h-1:0>a?0:a,b=b>=i?i-1:0>b?0:b,d.snapRowIndex=b,d.snapColIndex=a;var j=d.snapRowIndex*g,k=d.snapColIndex*f;d.scrollTo({x:k,y:j},e.snapDuration,e.snapEasing,c)},_snapAnimate:function(a){var b=this,c=b.userConfig,d=c.snapWidth,e=c.snapHeight,f=Math.abs(a.deltaX)>Math.abs(a.deltaY)?a.touch.directionX:a.touch.directionY;if(a.velocity>.5)"left"==f?b.snapColIndex++:"right"==f?b.snapColIndex--:void 0,"top"==f?b.snapRowIndex++:"bottom"==f?b.snapRowIndex--:void 0;else{var g=b.getOffset(),h=Math.abs(g.x),i=Math.abs(g.y);b.snapColIndex=Math.round(h/d),b.snapRowIndex=Math.round(i/e)}b.snapTo(b.snapColIndex,b.snapRowIndex)},_scrollAnimate:function(a){var b,c=this,d=(c.userConfig,c._bounce("x",a.velocityX)),e=c._bounce("y",a.velocityY),f=d?d.offset:0,g=e?e.offset:0;d&&e&&d.status&&e.status&&d.duration&&e.duration&&(b=Math.max(d.duration,e.duration)),d&&c.scrollX(f,b||d.duration,d.easing,function(){c._scrollEndHandler("x")}),e&&c.scrollY(g,b||e.duration,e.easing,function(){c._scrollEndHandler("y")}),c.directionX=a.velocityX<0?"left":"right",c.directionY=a.velocityY<0?"up":"down"},_scrollEndHandler:function(a){var b=this,c=a.toUpperCase(),d="scroll"+c,e="boundryCheck"+c,f="_bounce"+a,g=b.boundry,h=b.userConfig.bounceSize||0;if(b[f]){var i="x"==a?g.left:g.top,j="x"==a?g.right:g.bottom,k="x"==a?b.containerWidth:b.containerHeight,l={zoomType:a,velocityX:0,velocityY:0};if(l["velocity"+c]=b[f],b.fire("boundryout",l),b.userConfig.bounce){var m=b[f],n=.01*m/Math.abs(m),o=m/n,p=b.getOffset()[a]+o*m/2,q=100,r=150,s=0;p>i?(p>i+h&&(p=i+h),s=Math.abs(p-i)):j-k>p&&(j-k-h>p&&(p=j-k-h),s=Math.abs(j-k-p)),o=s/h*(r-q)+q,b[d](-p,o,"linear",function(){b[f]=0,b[e]()})}}else b[e]()},isBoundryOut:function(){return this.isBoundryOutLeft()||this.isBoundryOutRight()||this.isBoundryOutTop()||this.isBoundryOutBottom()},isBoundryOutLeft:function(){return-this.getOffsetLeft()<this.boundry.left},isBoundryOutRight:function(){return this.containerWidth+this.getOffsetLeft()<this.boundry.right},isBoundryOutTop:function(){return-this.getOffsetTop()<this.boundry.top},isBoundryOutBottom:function(){return this.containerHeight+this.getOffsetTop()<this.boundry.bottom},_bounce:function(a,b){var c=this,d=c.getOffset()[a],e=c.boundry,f="x"==a?e.left:e.top,g="x"==a?e.right:e.bottom,h="x"==a?c.containerWidth:c.containerHeight,i=g-f,j=c.userConfig,k={};if(0===b)return void("x"==a?c.boundryCheckX():c.boundryCheckY());if(!("x"==a&&c.userConfig.lockX||"y"==a&&c.userConfig.lockY)){var l=j.maxSpeed>0&&j.maxSpeed<6?j.maxSpeed:3;if(b>l&&(b=l),-l>b&&(b=-l),d>f||i-h>d){var m=j.BOUNDRY_CHECK_ACCELERATION*(b/Math.abs(b)),n=b/m,o=d+n*b/2;return k.offset=-o,k.duration=n,k}var m=c.SROLL_ACCELERATION*(b/Math.abs(b)),n=b/m,o=d/1+n*b/2;if(o>f){var p=f-d,q=(b-Math.sqrt(-2*m*p+b*b))/m;k.offset=-f,k.duration=q,k.easing="linear",c["_bounce"+a]=b-m*q,c._prevSpeed=0}else if(i-h>o){var p=i-h-d,q=(b+Math.sqrt(-2*m*p+b*b))/m;k.offset=h-i,k.duration=q,k.easing="linear",c["_bounce"+a]=b-m*q,c._prevSpeed=b-m*q}else k.offset=-o,k.duration=n,k.easing=c.userConfig.easing,k.status="normal",c["_bounce"+a]=0,c._prevSpeed=0;return c["isScrolling"+a.toUpperCase()]=!0,k}},addView:function(a){var b=this;if(a&&!(!a instanceof n))return b.__subViews||(b.__subViews=[]),a.guid&&!b.getViewById(a.guid)?(a.parentView={instance:b},a.on("boundryout",function(a){b._scrollAnimate(a)}),b.__subViews.push(a)):void 0},getViewById:function(a){var b=this;if(b.__subViews)for(var c=0,d=b.__subViews.length;d>c;c++)if(a&&a==b.__subViews[c].guid)return b.__subViews[c]},getViews:function(){return this.__subViews},removeView:function(a){for(var b=this,c=0,d=b.__subViews.length;d>c;c++)if(a&&a==b.__subViews[c].guid)return delete b.__subViews[c].parentView,b.__subViews.splice(c,1)}}),n},{requires:["./base","./util","./event","./pan","./tap","./pinch","./timer","./scrollbar","./pulldown","./pullup","./boundry","./easing"]});